using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Text;

namespace Unity.VisualScripting
{
    // Adapted from AssemblyQualifiedNameParser
    public class TypeName
    {
        public string AssemblyDescription { get; private set; }

        public string AssemblyName { get; private set; }

        public string AssemblyVersion { get; private set; }

        public string AssemblyCulture { get; private set; }

        public string AssemblyPublicKeyToken { get; private set; }

        public List<TypeName> GenericParameters { get; } = new List<TypeName>();

        private readonly List<string> names = new List<string>();

        private readonly List<int> genericarities = new List<int>();

        public string Name { get; private set; }

        public bool IsArray => Name.EndsWith("[]");

        public string LastName => names[names.Count - 1];

        public static TypeName Parse(string s)
        {
            var index = 0;
            return new TypeName(s, ref index);
        }

        private enum ParseState
        {
            Name,

            Array,

            Generics,

            Assembly
        }

        private TypeName(string s, ref int index)
        {
            try
            {
                var startIndex = index;

                var nameStartIndex = startIndex;
                var nameEndIndex = (int?)null;

                var assemblyDescriptionStartIndex = (int?)null;
                var assemblyDescriptionEndIndex = (int?)null;

                var hasGroupingBracket = false;

                var state = ParseState.Name;

                for (; index < s.Length; ++index)
                {
                    var currentCharacter = s[index];
                    var nextCharacter = index + 1 < s.Length ? s[index + 1] : (char?)null;

                    if (state == ParseState.Name)
                    {
                        if (currentCharacter == '[')
                        {
                            if (index == startIndex)
                            {
                                // Skip type grouping bracket
                                hasGroupingBracket = true;
                                nameStartIndex++;
                            }
                            else if (nextCharacter == ']' || nextCharacter == ',')
                            {
                                // Square bracket delimits an array
                                state = ParseState.Array;
                            }
                            else
                            {
                                // Square bracket delimits the generic argument list
                                nameEndIndex = index;
                                state = ParseState.Generics;
                            }
                        }
                        else if (currentCharacter == ']')
                        {
                            if (hasGroupingBracket)
                            {
                                // We finished the current grouping, break out
                                break;
                            }
                        }
                        else if (currentCharacter == ',')
                        {
                            // We're entering assembly description

                            state = ParseState.Assembly;

                            assemblyDescriptionStartIndex = index + 1;

                            if (nameEndIndex == null)
                            {
                                nameEndIndex = index;
                            }
                        }
                    }
                    else if (state == ParseState.Array)
                    {
                        if (currentCharacter == ']')
                        {
                            state = ParseState.Name;
                        }
                    }
                    else if (state == ParseState.Generics)
                    {
                        if (currentCharacter == ']')
                        {
                            state = ParseState.Name;
                        }
                        else if (currentCharacter == ',' || currentCharacter == ' ')
                        {
                            // Generic delimiters
                        }
                        else
                        {
                            GenericParameters.Add(new TypeName(s, ref index));
                        }
                    }
                    else if (state == ParseState.Assembly)
                    {
                        if (currentCharacter == ']')
                        {
                            if (hasGroupingBracket)
                            {
                                // We finished the current grouping, break out
                                assemblyDescriptionEndIndex = index;
                                break;
                            }
                        }
                    }
                }

                if (nameEndIndex == null)
                {
                    nameEndIndex = s.Length;
                }

                if (assemblyDescriptionEndIndex == null)
                {
                    assemblyDescriptionEndIndex = s.Length;
                }

                Name = s.Substring(nameStartIndex, nameEndIndex.Value - nameStartIndex);

                if (Name.Contains('+'))
                {
                    var nestedNames = Name.Split('+');

                    foreach (var nestedName in nestedNames)
                    {
                        nestedName.PartsAround('`', out var name, out var genericarity);

                        names.Add(name);

                        if (genericarity != null)
                        {
                            genericarities.Add(int.Parse(genericarity));
                        }
                        else
                        {
                            genericarities.Add(0);
                        }
                    }
                }
                else
                {
                    Name.PartsAround('`', out var name, out var genericarity);

                    names.Add(name);

                    if (genericarity != null)
                    {
                        genericarities.Add(int.Parse(genericarity));
                    }
                    else
                    {
                        genericarities.Add(0);
                    }
                }

                if (assemblyDescriptionStartIndex != null)
                {
                    AssemblyDescription = s.Substring(assemblyDescriptionStartIndex.Value, assemblyDescriptionEndIndex.Value - assemblyDescriptionStartIndex.Value);

                    var parts = AssemblyDescription.Split(',')
                        .Select(x => x.Trim())
                        .ToList();

                    AssemblyVersion = LookForPairThenRemove(parts, "Version");
                    AssemblyCulture = LookForPairThenRemove(parts, "Culture");
                    AssemblyPublicKeyToken = LookForPairThenRemove(parts, "PublicKeyToken");

                    if (parts.Count > 0)
                    {
                        AssemblyName = parts[0];
                    }
                }
            }
            catch (Exception ex)
            {
                throw new FormatException($"Failed to parse type name: {s}", ex);
            }
        }

        private static string LookForPairThenRemove(List<string> strings, string Name)
        {
            for (var istr = 0; istr < strings.Count; istr++)
            {
                var s = strings[istr];
                var i = s.IndexOf(Name);

                if (i == 0)
                {
                    var i2 = s.IndexOf('=');

                    if (i2 > 0)
                    {
                        var ret = s.Substring(i2 + 1);
                        strings.RemoveAt(istr);

                        return ret;
                    }
                }
            }

            return null;
        }

        public void ReplaceNamespace(string oldNamespace, string newNamespace)
        {
            if (names[0].StartsWith(oldNamespace + "."))
            {
                names[0] = newNamespace + "." + names[0].TrimStart(oldNamespace + ".");
            }

            foreach (var genericParameter in GenericParameters)
            {
                genericParameter.ReplaceNamespace(oldNamespace, newNamespace);
            }

            UpdateName();
        }

        public void ReplaceAssembly(string oldAssembly, string newAssembly)
        {
            if (AssemblyName != null && AssemblyName.StartsWith(oldAssembly))
            {
                AssemblyName = newAssembly + AssemblyName.TrimStart(oldAssembly);
            }

            foreach (var genericParameter in GenericParameters)
            {
                genericParameter.ReplaceAssembly(oldAssembly, newAssembly);
            }
        }

        public void ReplaceName(string oldTypeName, Type newType)
        {
            ReplaceName(oldTypeName, newType.FullName, newType.Assembly?.GetName());
        }

        public void ReplaceName(string oldTypeName, string newTypeName, AssemblyName newAssemblyName = null)
        {
            for (var i = 0; i < names.Count; i++)
            {
                if (ToElementTypeName(names[i]) == oldTypeName)
                {
                    names[i] = ToArrayOrType(names[i], newTypeName);

                    if (newAssemblyName != null)
                    {
                        SetAssemblyName(newAssemblyName);
                    }
                }
            }

            foreach (var genericParameter in GenericParameters)
            {
                genericParameter.ReplaceName(oldTypeName, newTypeName, newAssemblyName);
            }

            UpdateName();
        }

        // We never compare Arrays but just ElementTypes, so remove the square brackets from the old type
        static string ToElementTypeName(string s)
        {
            return s.EndsWith("[]") ? s.Replace("[]", string.Empty) : s;
        }

        // If the old type was an array, then set the new type as an array
        static string ToArrayOrType(string oldType, string newType)
        {
            if (oldType.EndsWith("[]"))
            {
                newType += "[]";
            }

            return newType;
        }

        public void SetAssemblyName(AssemblyName newAssemblyName)
        {
            AssemblyDescription = newAssemblyName.ToString();
            AssemblyName = newAssemblyName.Name;
            AssemblyCulture = newAssemblyName.CultureName;
            AssemblyVersion = newAssemblyName.Version.ToString();
            AssemblyPublicKeyToken = newAssemblyName.GetPublicKeyToken()?.ToHexString() ?? "null";
        }

        private void UpdateName()
        {
            var sb = new StringBuilder();

            for (var i = 0; i < names.Count; i++)
            {
                if (i != 0)
                {
                    sb.Append('+');
                }

                sb.Append(names[i]);

                if (genericarities[i] > 0)
                {
                    sb.Append('`');
                    sb.Append(genericarities[i]);
                }
            }

            Name = sb.ToString();
        }

        public string ToString(TypeNameDetail specification, TypeNameDetail genericsSpecification)
        {
            var sb = new StringBuilder();

            sb.Append(Name);

            if (GenericParameters.Count > 0)
            {
                sb.Append("[");

                var isFirstParameter = true;

                foreach (var genericParameter in GenericParameters)
                {
                    if (!isFirstParameter)
                    {
                        sb.Append(",");
                    }

                    if (genericsSpecification != TypeNameDetail.Name)
                    {
                        sb.Append("[");
                    }

                    sb.Append(genericParameter.ToString(genericsSpecification, genericsSpecification));

                    if (genericsSpecification != TypeNameDetail.Name)
                    {
                        sb.Append("]");
                    }

                    isFirstParameter = false;
                }

                sb.Append("]");
            }

            if (specification == TypeNameDetail.Full)
            {
                if (!string.IsNullOrEmpty(AssemblyDescription))
                {
                    sb.Append(", ");
                    sb.Append(AssemblyDescription);
                }
            }
            else if (specification == TypeNameDetail.NameAndAssembly)
            {
                if (!string.IsNullOrEmpty(AssemblyName))
                {
                    sb.Append(", ");
                    sb.Append(AssemblyName);
                }
            }

            return sb.ToString();
        }

        public override string ToString()
        {
            return ToString(TypeNameDetail.Name, TypeNameDetail.Full);
        }

        public string ToLooseString()
        {
            // Removes the Culture, Token and VersionNumber
            return ToString(TypeNameDetail.NameAndAssembly, TypeNameDetail.NameAndAssembly);
        }

        public static string Simplify(string typeName)
        {
            return Parse(typeName).ToLooseString();
        }

        public static string SimplifyFast(string typeName)
        {
            // This assumes type strings are written with ', Version=' first, which
            // is standard for Type.AssemblyQualifiedName but not technically spec guaranteed.
            // It is however incredibly faster than parsing the type name and re-outputting it.

            while (true)
            {
                var startIndex = typeName.IndexOf(", Version=", StringComparison.Ordinal);

                if (startIndex >= 0)
                {
                    var endIndex = typeName.IndexOf(']', startIndex);

                    if (endIndex >= 0)
                    {
                        typeName = typeName.Remove(startIndex, endIndex - startIndex);
                    }
                    else
                    {
                        typeName = typeName.Substring(0, startIndex);
                        break;
                    }
                }
                else
                {
                    break;
                }
            }

            return typeName;
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Reflection;
using UnityEngine;
using UnityObject = UnityEngine.Object;

namespace Unity.VisualScripting
{
    public static class TypeUtility
    {
        private static readonly HashSet<Type> _numericTypes = new HashSet<Type>
        {
            typeof(byte),
            typeof(sbyte),
            typeof(short),
            typeof(ushort),
            typeof(int),
            typeof(uint),
            typeof(long),
            typeof(ulong),
            typeof(float),
            typeof(double),
            typeof(decimal)
        };

        private static readonly HashSet<Type> _numericConstructTypes = new HashSet<Type>
        {
            typeof(Vector2),
            typeof(Vector3),
            typeof(Vector4),
            typeof(Quaternion),
            typeof(Matrix4x4),
            typeof(Rect),
        };

        private static readonly HashSet<Type> typesWithShortStrings = new HashSet<Type>()
        {
            typeof(string),
            typeof(Vector2),
            typeof(Vector3),
            typeof(Vector4)
        };

        public static bool IsBasic(this Type type)
        {
            Ensure.That(nameof(type)).IsNotNull(type);

            if (type == typeof(string) || type == typeof(decimal))
            {
                return true;
            }

            if (type.IsEnum)
            {
                return true;
            }

            if (type.IsPrimitive)
            {
                if (type == typeof(IntPtr) || type == typeof(UIntPtr))
                {
                    return false;
                }

                return true;
            }

            return false;
        }

        public static bool IsNumeric(this Type type)
        {
            Ensure.That(nameof(type)).IsNotNull(type);

            return _numericTypes.Contains(type);
        }

        public static bool IsNumericConstruct(this Type type)
        {
            Ensure.That(nameof(type)).IsNotNull(type);

            return _numericConstructTypes.Contains(type);
        }

        public static Namespace Namespace(this Type type)
        {
            return Unity.VisualScripting.Namespace.FromFullName(type.Namespace);
        }

        public static Func<object> Instantiator(this Type type, bool nonPublic = true)
        {
            var instantiator = type.Instantiator(nonPublic, Empty<Type>.array);

            if (instantiator != null)
            {
                return () => instantiator.Invoke(Empty<object>.array);
            }

            return null;
        }

        public static Func<object[], object> Instantiator(this Type type, bool nonPublic = true, params Type[] parameterTypes)
        {
            // Unity objects cannot be instantiated via constructor
            if (typeof(UnityObject).IsAssignableFrom(type))
            {
                return null;
            }

            // Value types don't have parameterless constructors at the IL level
            // http://stackoverflow.com/questions/3751519/
            if ((type.IsValueType || type.IsBasic()) && parameterTypes.Length == 0)
            {
                return (args) => type.PseudoDefault();
            }

            // Look for matching constructor
            var constructor = type.GetConstructorAccepting(parameterTypes, nonPublic);

            if (constructor != null)
            {
                return (args) => constructor.Invoke(args);
            }

            // Can't instantiate from given access and parameter types
            return null;
        }

        public static object TryInstantiate(this Type type, bool nonPublic = true, params object[] args)
        {
            Ensure.That(nameof(type)).IsNotNull(type);

            var instantiator = type.Instantiator(nonPublic, args.Select(arg => arg.GetType()).ToArray());

            return instantiator?.Invoke(args);
        }

        public static object Instantiate(this Type type, bool nonPublic = true, params object[] args)
        {
            Ensure.That(nameof(type)).IsNotNull(type);

            var parameterTypes = args.Select(arg => arg.GetType()).ToArray();

            var instantiator = type.Instantiator(nonPublic, parameterTypes);

            if (instantiator == null)
            {
                throw new ArgumentException($"Type {type} cannot be{(nonPublic ? "" : " publicly")} instantiated with the provided parameter types: {parameterTypes.ToCommaSeparatedString()}");
            }

            return instantiator(args);
        }

        public static object Default(this Type type)
        {
            Ensure.That(nameof(type)).IsNotNull(type);

            if (type.IsReferenceType())
            {
                return null;
            }

            if (!defaultPrimitives.TryGetValue(type, out var defaultPrimitive))
            {
                defaultPrimitive = Activator.CreateInstance(type);
            }

            return defaultPrimitive;
        }

        public static object PseudoDefault(this Type type)
        {
            if (type == typeof(Color))
            {
                return Color.white;
            }
            else if (type == typeof(string))
            {
                return string.Empty;
            }
            else if (type.IsEnum)
            {
                // Support the [DefaultValue] attribute, fallback to zero-value
                // https://stackoverflow.com/questions/529929

                var values = Enum.GetValues(type);

                if (values.Length == 0)
                {
                    Debug.LogWarning($"Empty enum: {type}\nThis may cause problems with serialization.");
                    return Activator.CreateInstance(type);
                }

                var attribute = type.GetAttribute<DefaultValueAttribute>();

                if (attribute != null)
                {
                    return attribute.Value;
                }

                return values.GetValue(0);
            }

            return type.Default();
        }

        private static readonly Dictionary<Type, object> defaultPrimitives = new Dictionary<Type, object>()
        {
            { typeof(int), default(int) },
            { typeof(uint), default(uint) },
            { typeof(long), default(long) },
            { typeof(ulong), default(ulong) },
            { typeof(short), default(short) },
            { typeof(ushort), default(ushort) },
            { typeof(byte), default(byte) },
            { typeof(sbyte), default(sbyte) },
            { typeof(float), default(float) },
            { typeof(double), default(double) },
            { typeof(decimal), default(decimal) },
            { typeof(Vector2), default(Vector2) },
            { typeof(Vector3), default(Vector3) },
            { typeof(Vector4), default(Vector4) },
        };

        public static bool IsStatic(this Type type)
        {
            return type.IsAbstract && type.IsSealed;
        }

        public static bool IsAbstract(this Type type)
        {
            // Do not return true for static types
            return type.IsAbstract && !type.IsSealed;
        }

        public static bool IsConcrete(this Type type)
        {
            return !type.IsAbstract && !type.IsInterface && !type.ContainsGenericParameters;
        }

        public static IEnumerable<Type> GetInterfaces(this Type type, bool includeInherited)
        {
            if (includeInherited || type.BaseType == null)
            {
                return type.GetInterfaces();
            }
            else
            {
                return type.GetInterfaces().Except(type.BaseType.GetInterfaces());
            }
        }

        public static IEnumerable<Type> BaseTypeAndInterfaces(this Type type, bool inheritedInterfaces = true)
        {
            var types = Enumerable.Empty<Type>();

            if (type.BaseType != null)
            {
                types = types.Concat(type.BaseType.Yield());
            }

            types = types.Concat(type.GetInterfaces(inheritedInterfaces));

            return types;
        }

        public static IEnumerable<Type> Hierarchy(this Type type)
        {
            var baseType = type.BaseType;

            while (baseType != null)
            {
                yield return baseType;

                foreach (var @interface in baseType.GetInterfaces(false))
                {
                    yield return @interface;
                }

                baseType = baseType.BaseType;
            }
        }

        public static IEnumerable<Type> AndBaseTypeAndInterfaces(this Type type)
        {
            return type.Yield().Concat(type.BaseTypeAndInterfaces());
        }

        public static IEnumerable<Type> AndInterfaces(this Type type)
        {
            return type.Yield().Concat(type.GetInterfaces());
        }

        public static IEnumerable<Type> AndHierarchy(this Type type)
        {
            return type.Yield().Concat(type.Hierarchy());
        }

        public static Type GetListElementType(Type listType, bool allowNonGeneric)
        {
            if (listType == null)
            {
                throw new ArgumentNullException(nameof(listType));
            }

            // http://stackoverflow.com/questions/4452590

            if (listType.IsArray)
            {
                return listType.GetElementType();
            }
            else if (typeof(IList).IsAssignableFrom(listType))
            {
                var genericListInterface =
                    listType
                        .AndInterfaces()
                        .FirstOrDefault(i => i.IsGenericType && i.GetGenericTypeDefinition() == typeof(IList<>));

                if (genericListInterface == null)
                {
                    if (allowNonGeneric)
                    {
                        return typeof(object);
                    }
                    else
                    {
                        return null;
                    }
                }

                return genericListInterface.GetGenericArguments()[0];
            }
            else
            {
                return null;
            }
        }

        public static Type GetEnumerableElementType(Type enumerableType, bool allowNonGeneric)
        {
            if (enumerableType == null)
            {
                throw new ArgumentNullException(nameof(enumerableType));
            }

            // http://stackoverflow.com/a/12728562

            if (typeof(IEnumerable).IsAssignableFrom(enumerableType))
            {
                var genericEnumerableInterface =
                    enumerableType
                        .AndInterfaces()
                        .FirstOrDefault(i => i.IsGenericType && i.GetGenericTypeDefinition() == typeof(IEnumerable<>));

                if (genericEnumerableInterface == null)
                {
                    if (allowNonGeneric)
                    {
                        return typeof(object);
                    }
                    else
                    {
                        return null;
                    }
                }

                return genericEnumerableInterface.GetGenericArguments()[0];
            }
            else
            {
                return null;
            }
        }

        public static Type GetDictionaryItemType(Type dictionaryType, bool allowNonGeneric, int genericArgumentIndex)
        {
            if (dictionaryType == null)
            {
                throw new ArgumentNullException(nameof(dictionaryType));
            }

            if (typeof(IDictionary).IsAssignableFrom(dictionaryType))
            {
                var genericDictionaryInterface =
                    dictionaryType
                        .AndInterfaces()
                        .FirstOrDefault(i => i.IsGenericType && i.GetGenericTypeDefinition() == typeof(IDictionary<,>));

                if (genericDictionaryInterface == null)
                {
                    if (allowNonGeneric)
                    {
                        return typeof(object);
                    }
                    else
                    {
                        return null;
                    }
                }

                return genericDictionaryInterface.GetGenericArguments()[genericArgumentIndex];
            }
            else
            {
                return null;
            }
        }

        public static Type GetDictionaryKeyType(Type dictionaryType, bool allowNonGeneric)
        {
            return GetDictionaryItemType(dictionaryType, allowNonGeneric, 0);
        }

        public static Type GetDictionaryValueType(Type dictionaryType, bool allowNonGeneric)
        {
            return GetDictionaryItemType(dictionaryType, allowNonGeneric, 1);
        }

        public static bool IsNullable(this Type type)
        {
            // http://stackoverflow.com/a/1770232
            return type.IsReferenceType() || Nullable.GetUnderlyingType(type) != null;
        }

        public static bool IsReferenceType(this Type type)
        {
            return !type.IsValueType;
        }

        public static bool IsStruct(this Type type)
        {
            return type.IsValueType && !type.IsPrimitive && !type.IsEnum;
        }

        public static bool IsAssignableFrom(this Type type, object value)
        {
            if (value == null)
            {
                return type.IsNullable();
            }
            else
            {
                return type.IsInstanceOfType(value);
            }
        }

        public static bool CanMakeGenericTypeVia(this Type openConstructedType, Type closedConstructedType)
        {
            Ensure.That(nameof(openConstructedType)).IsNotNull(openConstructedType);
            Ensure.That(nameof(closedConstructedType)).IsNotNull(closedConstructedType);

            if (openConstructedType == closedConstructedType)
            {
                return true;
            }

            if (openConstructedType.IsGenericParameter) // e.g.: T
            {
                // The open-constructed type is a generic parameter.

                // First, check if all special attribute constraints are respected.

                var constraintAttributes = openConstructedType.GenericParameterAttributes;

                if (constraintAttributes != GenericParameterAttributes.None)
                {
                    // e.g.: where T : struct
                    if (constraintAttributes.HasFlag(GenericParameterAttributes.NotNullableValueTypeConstraint) &&
                        !closedConstructedType.IsValueType)
                    {
                        return false;
                    }

                    // e.g.: where T : class
                    if (constraintAttributes.HasFlag(GenericParameterAttributes.ReferenceTypeConstraint) &&
                        closedConstructedType.IsValueType)
                    {
                        return false;
                    }

                    // e.g.: where T : new()
                    if (constraintAttributes.HasFlag(GenericParameterAttributes.DefaultConstructorConstraint) &&
                        closedConstructedType.GetConstructor(Type.EmptyTypes) == null)
                    {
                        return false;
                    }
                }

                // Then, check if all type constraints are respected.

                // e.g.: where T : BaseType, IInterface1, IInterface2
                foreach (var constraint in openConstructedType.GetGenericParameterConstraints())
                {
                    if (!constraint.IsAssignableFrom(closedConstructedType))
                    {
                        return false;
                    }
                }

                return true;
            }
            else if (openConstructedType.ContainsGenericParameters)
            {
                // The open-constructed type is not a generic parameter but contains generic parameters.
                // It could be either a generic type or an array.

                if (openConstructedType.IsGenericType) // e.g. Generic<T1, int, T2>
                {
                    // The open-constructed type is a generic type.

                    var openConstructedGenericDefinition = openConstructedType.GetGenericTypeDefinition(); // e.g.: Generic<,,>

                    // Check a list of possible candidate closed-constructed types:
                    //  - the closed-constructed type itself
                    //  - its base type, if any (i.e.: if the closed-constructed type is not object)
                    //  - its implemented interfaces

                    foreach (var inheritedClosedConstructedType in closedConstructedType.AndBaseTypeAndInterfaces())
                    {
                        if (inheritedClosedConstructedType.IsGenericType &&
                            inheritedClosedConstructedType.GetGenericTypeDefinition() == openConstructedGenericDefinition)
                        {
                            // The inherited closed-constructed type and the open-constructed type share the same generic definition.

                            var inheritedClosedConstructedGenericArguments = inheritedClosedConstructedType.GetGenericArguments(); // e.g.: { float, int, string }

                            // For each open-constructed generic argument, recursively check if it
                            // can be made into a closed-constructed type via the closed-constructed generic argument.

                            var openConstructedGenericArguments = openConstructedType.GetGenericArguments(); // e.g.: { T1, int, T2 }
                            for (var i = 0; i < openConstructedGenericArguments.Length; i++)
                            {
                                if (!openConstructedGenericArguments[i].CanMakeGenericTypeVia(inheritedClosedConstructedGenericArguments[i])) // !T1.IsAssignableFromGeneric(float)
                                {
                                    return false;
                                }
                            }

                            // The inherited closed-constructed type matches the generic definition of
                            // the open-constructed type and each of its type arguments are assignable to each equivalent type
                            // argument of the constraint.

                            return true;
                        }
                    }

                    // The open-constructed type contains generic parameters, but no
                    // inherited closed-constructed type has a matching generic definition.

                    return false;
                }
                else if (openConstructedType.IsArray) // e.g. T[]
                {
                    // The open-constructed type is an array.

                    if (!closedConstructedType.IsArray ||
                        closedConstructedType.GetArrayRank() != openConstructedType.GetArrayRank())
                    {
                        // Fail if the closed-constructed type isn't an array of the same rank.
                        return false;
                    }

                    var openConstructedElementType = openConstructedType.GetElementType();
                    var closedConstructedElementType = closedConstructedType.GetElementType();

                    return openConstructedElementType.CanMakeGenericTypeVia(closedConstructedElementType);
                }
                else if (openConstructedType.IsByRef) // e.g. T&
                {
                    // The open-constructed type is by ref.

                    if (!closedConstructedType.IsByRef)
                    {
                        // Fail if the closed-constructed type isn't also by ref.
                        return false;
                    }

                    var openConstructedElementType = openConstructedType.GetElementType();
                    var closedConstructedElementType = closedConstructedType.GetElementType();

                    return openConstructedElementType.CanMakeGenericTypeVia(closedConstructedElementType);
                }
                else
                {
                    throw new NotImplementedException();
                }
            }
            else
            {
                // The open-constructed type does not contain generic parameters,
                // we can proceed to a regular closed-type check.

                return openConstructedType.IsAssignableFrom(closedConstructedType);
            }
        }

        public static Type MakeGenericTypeVia(this Type openConstructedType, Type closedConstructedType, Dictionary<Type, Type> resolvedGenericParameters, bool safe = true)
        {
            Ensure.That(nameof(openConstructedType)).IsNotNull(openConstructedType);
            Ensure.That(nameof(closedConstructedType)).IsNotNull(closedConstructedType);
            Ensure.That(nameof(resolvedGenericParameters)).IsNotNull(resolvedGenericParameters);

            if (safe && !openConstructedType.CanMakeGenericTypeVia(closedConstructedType))
            {
                throw new GenericClosingException(openConstructedType, closedConstructedType);
            }

            if (openConstructedType == closedConstructedType)
            {
                return openConstructedType;
            }

            if (openConstructedType.IsGenericParameter) // e.g.: T
            {
                // The open-constructed type is a generic parameter.
                // We can directly map it to the closed-constructed type.

                // Because this is the lowest possible level of type resolution,
                // we will add this entry to our list of resolved generic parameters
                // in case we need it later (e.g. for resolving generic methods).

                // Note that we allow an open-constructed type to "make" another
                // open-constructed type, as long as the former respects all of
                // the latter's constraints. Therefore, we will only add the resolved
                // parameter to our dictionary if it actually is resolved.

                if (!closedConstructedType.ContainsGenericParameters)
                {
                    if (resolvedGenericParameters.ContainsKey(openConstructedType))
                    {
                        if (resolvedGenericParameters[openConstructedType] != closedConstructedType)
                        {
                            throw new InvalidOperationException("Nested generic parameters resolve to different values.");
                        }
                    }
                    else
                    {
                        resolvedGenericParameters.Add(openConstructedType, closedConstructedType);
                    }
                }

                return closedConstructedType;
            }
            else if (openConstructedType.ContainsGenericParameters) // e.g.: Generic<T1, int, T2>
            {
                // The open-constructed type is not a generic parameter but contains generic parameters.
                // It could be either a generic type or an array.

                if (openConstructedType.IsGenericType) // e.g. Generic<T1, int, T2>
                {
                    // The open-constructed type is a generic type.

                    var openConstructedGenericDefinition = openConstructedType.GetGenericTypeDefinition(); // e.g.: Generic<,,>
                    var openConstructedGenericArguments = openConstructedType.GetGenericArguments(); // e.g.: { T1, int, T2 }

                    // Check a list of possible candidate closed-constructed types:
                    //  - the closed-constructed type itself
                    //  - its base type, if any (i.e.: if the closed-constructed type is not object)
                    //  - its implemented interfaces

                    foreach (var inheritedCloseConstructedType in closedConstructedType.AndBaseTypeAndInterfaces())
                    {
                        if (inheritedCloseConstructedType.IsGenericType &&
                            inheritedCloseConstructedType.GetGenericTypeDefinition() == openConstructedGenericDefinition)
                        {
                            // The inherited closed-constructed type and the open-constructed type share the same generic definition.

                            var inheritedClosedConstructedGenericArguments = inheritedCloseConstructedType.GetGenericArguments(); // e.g.: { float, int, string }

                            // For each inherited open-constructed type generic argument, recursively resolve it
                            // via the equivalent closed-constructed type generic argument.

                            var closedConstructedGenericArguments = new Type[openConstructedGenericArguments.Length];

                            for (var j = 0; j < openConstructedGenericArguments.Length; j++)
                            {
                                closedConstructedGenericArguments[j] = MakeGenericTypeVia
                                    (
                                    openConstructedGenericArguments[j],
                                    inheritedClosedConstructedGenericArguments[j],
                                    resolvedGenericParameters,
                                    safe: false // We recursively checked before, no need to do it again
                                    );

                                // e.g.: Resolve(T1, float)
                            }

                            // Construct the final closed-constructed type from the resolved arguments

                            return openConstructedGenericDefinition.MakeGenericType(closedConstructedGenericArguments);
                        }
                    }

                    // The open-constructed type contains generic parameters, but no
                    // inherited closed-constructed type has a matching generic definition.
                    // This cannot happen in safe mode, but could in unsafe mode.

                    throw new GenericClosingException(openConstructedType, closedConstructedType);
                }
                else if (openConstructedType.IsArray) // e.g. T[]
                {
                    var arrayRank = openConstructedType.GetArrayRank();

                    // The open-constructed type is an array.

                    if (!closedConstructedType.IsArray ||
                        closedConstructedType.GetArrayRank() != arrayRank)
                    {
                        // Fail if the closed-constructed type isn't an array of the same rank.
                        // This cannot happen in safe mode, but could in unsafe mode.
                        throw new GenericClosingException(openConstructedType, closedConstructedType);
                    }

                    var openConstructedElementType = openConstructedType.GetElementType();
                    var closedConstructedElementType = closedConstructedType.GetElementType();

                    return openConstructedElementType.MakeGenericTypeVia
                        (
                            closedConstructedElementType,
                            resolvedGenericParameters,
                            safe: false
                        ).MakeArrayType(arrayRank);
                }
                else if (openConstructedType.IsByRef) // e.g. T&
                {
                    // The open-constructed type is by ref.

                    if (!closedConstructedType.IsByRef)
                    {
                        // Fail if the closed-constructed type isn't also by ref.
                        // This cannot happen in safe mode, but could in unsafe mode.
                        throw new GenericClosingException(openConstructedType, closedConstructedType);
                    }

                    var openConstructedElementType = openConstructedType.GetElementType();
                    var closedConstructedElementType = closedConstructedType.GetElementType();

                    return openConstructedElementType.MakeGenericTypeVia
                        (
                            closedConstructedElementType,
                            resolvedGenericParameters,
                            safe: false
                        ).MakeByRefType();
                }
                else
                {
                    throw new NotImplementedException();
                }
            }
            else
            {
                // The open-constructed type does not contain generic parameters,
                // it is by definition already resolved.

                return openConstructedType;
            }
        }

        public static string ToShortString(this object o, int maxLength = 20)
        {
            var type = o?.GetType();

            if (type == null || o.IsUnityNull())
            {
                return "Null";
            }
            else if (type == typeof(float))
            {
                return ((float)o).ToString("0.##");
            }
            else if (type == typeof(double))
            {
                return ((double)o).ToString("0.##");
            }
            else if (type == typeof(decimal))
            {
                return ((decimal)o).ToString("0.##");
            }
            else if (type.IsBasic() || typesWithShortStrings.Contains(type))
            {
                return o.ToString().Truncate(maxLength);
            }
            else if (typeof(UnityObject).IsAssignableFrom(type))
            {
                return ((UnityObject)o).name.Truncate(maxLength);
            }
            else
            {
                return null;
            }
        }

        public static IEnumerable<Type> GetTypesSafely(this Assembly assembly)
        {
            Type[] types;

            try
            {
                types = assembly.GetTypes();
            }
            catch (ReflectionTypeLoadException ex) when (ex.Types.Any(t => t != null))
            {
                types = ex.Types.Where(t => t != null).ToArray();
            }
            catch (Exception ex)
            {
                Debug.LogWarning($"Failed to load types in assembly '{assembly}'.\n{ex}");
                yield break;
            }

            foreach (var type in types)
            {
                // Apparently void can be returned somehow:
                // http://support.ludiq.io/topics/483
                if (type == typeof(void))
                {
                    continue;
                }

                yield return type;
            }
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              INDX( 	 I‹R           (   ¿  Ë       Ÿ  ŸŸŸ e         £ò    x f     ¢ò    ‘⁄kY¿ÏŸ PõÓÇ§ŸÃrÅ¿‰Ÿ‘⁄kY¿ÏŸ        K               A d d i t i o n H a n d l e r . c s   §ò    Ä p     ¢ò    ¿(lY¿ÏŸ PõÓÇ§Ÿ∂FqÅ¿‰ŸµOlY¿ÏŸ¯       Û                A d d i t i o n H a n d l e r . c s . m e t a ˚ê    ê |     ¢ò    qY¢ÁÏŸ‡πˆ˙ùØŸ ˜
ÁÏŸ LÕ$ËÏŸp      l               A m b i g u o u s O p e r a t o r E x c e p t i o n . c s . m ¶ò    ò Ü     ¢ò    ãÎlY¿ÏŸ PõÓÇ§Ÿ•4oÅ¿‰Ÿ˘mY¿Ï ¯       Û               " A m b i g u o u s O p e r a t o r E x c e p t i o n . c s . m e t a   ˜ê    p \     ¢ò    j„°ÁÏŸ‡πˆ˙ùØŸ ˜
ÁÏŸ LÕ$ËÏŸ       à               A n d H a n d l e r . c s . m ®ò    x f     ¢ò    ^ƒmY¿ÏŸ PõÓÇ§ŸåàlÅ¿‰Ÿ^ƒmY¿ÏŸ¯       Û                A n d H a n d l e r . c s . m e t a   ˘ê    x d     ¢ò    qY¢ÁÏŸ‡πˆ˙ùØŸ ˜
ÁÏŸ%Õ$ËÏŸà      á               B i n a r y O p e r a t o r . c s . m ™ò    Ä n     ¢ò    JânY¿ÏŸ PõÓÇ§ŸµjÅ¿‰Ÿ∏±nY¿ÏŸ¯      Û                B i n a r y O p e r a t o r . c s . m e t a   ´ò    à r     ¢ò    À oY¿ÏŸ PõÓÇ§ŸıìiÅ¿‰ŸÀ oY¿ÏŸ        c               B i n a r y O p e r a t o r H a n d l e r . c s       ¨ò    ê |     ¢ò    ¢MoY¿ÏŸ PõÓÇ§ŸÊhÅ¿‰ŸòtoY¿ÏŸ¯       Û                B i n a r y O p e r a t o r H a n d l e r . c s . m e t a     ë    x h     ¢ò    ËÓ¢ÁÏŸ V˜˙ùØŸ˜P
ÁÏŸWÍÃ$ËÏŸx      s               D e c r e m e n t H a n d l e r . c s Æò    à r     ¢ò    9pY¿ÏŸ PõÓÇ§Ÿr!fÅ¿‰ C6pY¿ÏŸ¯       Û                D e c r e m e n t H a n d l e r . c s . m e t a       Øò    x f     ¢ò    ¿äpY¿ÏŸ PõÓÇ§ŸMeÅ¿‰Ÿ¿äpY¿ÏŸ        ˝               D i v i s i o n H a n d l e r . c s   ∞ò    Ä p     ¢ò    ÈŸpY¿ÏŸ PõÓÇ§ŸgPcÅ¿‰Ÿ‰ˇpY¿ÏŸ¯       Û                D i v i s i o n H a n d l e r . c s . m e t a ±ò    x f     ¢ò    ÑQqY¿ÏŸ PõÓÇ§ŸöbÅ¿‰ŸÑQqY¿ÏŸ                       E q u a l i t y H a n d l e r . c s                 ¢ò    müqY¿ÏŸ PõÓÇ§Ÿ``Å¿‰ŸÓΩqY¿Ï ¯       Û                E q u a l i t y H a n d l e r . c s . m e t a ≥ò    Ä l     ¢ò    §ÚqY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ™rY¿ÏŸ       ´               E x c l u s i v e O r H a n d l e r . c s     ¥ò    à v     ¢ò    DCrY¿ÏŸ PõÓÇ§Ÿµ]Å¿‰ŸLlrY¿ÏŸ¯       Û                E x c l u s i v e O r H a n d l e r . c s . m e t a   µò    Ä l     ¢ò    9∏rY¿ÏŸ PõÓÇ§Ÿ	‡\Å¿‰Ÿ9∏rY¿ÏŸ                       G r e a t e r T h a n H a n d l e r . c s     ∂ò    à v     ¢ò    Î"sY¿ÏŸ PõÓÇ§Ÿ)R[Å¿‰ Î"sY¿ÏŸ¯       Û                G r e a t e r T h a n H a n d l e r . c s . m e t a   ∑ò    ê z     ¢ò    ÍpsY¿ÏŸ PõÓÇ§ŸÔAZÅ¿‰Ÿ‡ósY¿ÏŸ        €               G r e a t e r T h a n O r E q u a l H a n d l e r . c s       ∏ò    ò Ñ     ¢ò    …ÂsY¿ÏŸ PõÓÇ§ŸﬂªXÅ¿‰Ÿ…ÂsY¿ÏŸ¯       Û               ! G r e a t e r T h a n O r E q u a l H a n d l e r . c s . m e t a     πò    x h     ¢ò    ¥3tY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ[tY¿ÏŸx      s               I n c r e m e n t H a n d l e r . c s ∫ò    à r     ¢ò    ΩêtY¿ÏŸ PõÓÇ§ŸuöVÅ¿‰Ÿ¡∑tY¿ÏŸ¯       Û                I n c r e m e n t H a n d l e r . c s . m e t a       ªò    Ä j     ¢ò    fÙtY¿ÏŸ PõÓÇ§Ÿ^<UÅ¿‰ŸmuY¿ÏŸ                       I n e q u a l i t y H a n d l e r . c s       ºò    à t     ¢ò    TiuY¿ÏŸ PõÓÇ§ŸKèSÅ¿‰ŸósuY¿ÏŸ¯       Û                I n e q u a l i t y H a n d l e r . c s . m e t a     Ωò    à x     ¢ò    xºuY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸxºuY¿ÏŸ                      I n v a l i d O p e r a t o r E x c  p t i o n . c s æò    ò Ç     ¢ò    n1vY¿ÏŸ PõÓÇ§Ÿ…•QÅ¿‰Ÿñ>vY¿ÏŸ¯       Û                 I n v a l i d O p e r a t o r E x c e p t i o n . c s . m e t a       øò    x h     ¢ò    wvY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸˆûvY¿ÏŸ       ‹               L e f t S h i f t H a n d l e r . c s ¿ò    à r     ¢ò    ﬂÏvY¿ÏŸ PõÓÇ§Ÿ^{OÅ¿‰Ÿµ¯vY¿ÏŸ¯       Û                L e f t S h i f t H a n d l e r . c s . m e t a                                                                                            using System;
using System.Collections.Generic;
using System.Reflection;

namespace Unity.VisualScripting
{
    public abstract class BinaryOperatorHandler : OperatorHandler
    {
        protected BinaryOperatorHandler(string name, string verb, string symbol, string customMethodName)
            : base(name, verb, symbol, customMethodName) { }

        private readonly Dictionary<OperatorQuery, Func<object, object, object>> handlers = new Dictionary<OperatorQuery, Func<object, object, object>>();
        private readonly Dictionary<OperatorQuery, IOptimizedInvoker> userDefinedOperators = new Dictionary<OperatorQuery, IOptimizedInvoker>();
        private readonly Dictionary<OperatorQuery, OperatorQuery> userDefinedOperandTypes = new Dictionary<OperatorQuery, OperatorQuery>();

        public virtual object Operate(object leftOperand, object rightOperand)
        {
            OperatorQuery query;

            var leftType = leftOperand?.GetType();
            var rightType = rightOperand?.GetType();

            if (leftType != null && rightType != null)
            {
                query = new OperatorQuery(leftType, rightType);
            }
            else if (leftType != null && leftType.IsNullable())
            {
                query = new OperatorQuery(leftType, leftType);
            }
            else if (rightType != null && rightType.IsNullable())
            {
                query = new OperatorQuery(rightType, rightType);
            }
            else if (leftType == null && rightType == null)
            {
                return BothNullHandling();
            }
            else
            {
                return SingleNullHandling();
            }

            if (handlers.ContainsKey(query))
            {
                return handlers[query](leftOperand, rightOperand);
            }

            if (customMethodName != null)
            {
                if (!userDefinedOperators.ContainsKey(query))
                {
                    var leftMethod = query.leftType.GetMethod(customMethodName, BindingFlags.Public | BindingFlags.Static, null, new[] { query.leftType, query.rightType }, null);

                    if (query.leftType != query.rightType)
                    {
                        var rightMethod = query.rightType.GetMethod(customMethodName, BindingFlags.Public | BindingFlags.Static, null, new[] { query.leftType, query.rightType }, null);

                        if (leftMethod != null && rightMethod != null)
                        {
                            throw new AmbiguousOperatorException(symbol, query.leftType, query.rightType);
                        }

                        var method = (leftMethod ?? rightMethod);

                        if (method != null)
                        {
                            userDefinedOperandTypes.Add(query, ResolveUserDefinedOperandTypes(method));
                        }

                        userDefinedOperators.Add(query, method?.Prewarm());
                    }
                    else
                    {
                        if (leftMethod != null)
                        {
                            userDefinedOperandTypes.Add(query, ResolveUserDefinedOperandTypes(leftMethod));
                        }

                        userDefinedOperators.Add(query, leftMethod?.Prewarm());
                    }
                }

                if (userDefinedOperators[query] != null)
                {
                    leftOperand = ConversionUtility.Convert(leftOperand, userDefinedOperandTypes[query].leftType);
                    rightOperand = ConversionUtility.Convert(rightOperand, userDefinedOperandTypes[query].rightType);

                    return userDefinedOperators[query].Invoke(null, leftOperand, rightOperand);
                }
            }

            return CustomHandling(leftOperand, rightOperand);
        }

        protected virtual object CustomHandling(object leftOperand, object rightOperand)
        {
            throw new InvalidOperatorException(symbol, leftOperand?.GetType(), rightOperand?.GetType());
        }

        protected virtual object BothNullHandling()
        {
            throw new InvalidOperatorException(symbol, null, null);
        }

        protected virtual object SingleNullHandling()
        {
            throw new InvalidOperatorException(symbol, null, null);
        }

        protected void Handle<TLeft, TRight>(Func<TLeft, TRight, object> handler, bool reverse = false)
        {
            var query = new OperatorQuery(typeof(TLeft), typeof(TRight));

            if (handlers.ContainsKey(query))
            {
                throw new ArgumentException($"A handler is already registered for '{typeof(TLeft)} {symbol} {typeof(TRight)}'.");
            }

            handlers.Add(query, (left, right) => handler((TLeft)left, (TRight)right));

            if (reverse && typeof(TLeft) != typeof(TRight))
            {
                var reverseQuery = new OperatorQuery(typeof(TRight), typeof(TLeft));

                if (!handlers.ContainsKey(reverseQuery))
                {
                    handlers.Add(reverseQuery, (left, right) => handler((TLeft)left, (TRight)right));
                }
            }
        }

        private static OperatorQuery ResolveUserDefinedOperandTypes(MethodInfo userDefinedOperator)
        {
            // We will need to convert the operands to the argument types,
            // because .NET is actually permissive of implicit conversion
            // in its GetMethod calls. For example, an operator requiring
            // a float operand will accept an int. However, our optimized
            // reflection code is more strict, and will only accept the
            // exact type, hence why we need to manually store the expected
            // parameter types here to convert them later.
            var parameters = userDefinedOperator.GetParameters();
            return new OperatorQuery(parameters[0].ParameterType, parameters[1].ParameterType);
        }

        private struct OperatorQuery : IEquatable<OperatorQuery>
        {
            public readonly Type leftType;
            public readonly Type rightType;

            public OperatorQuery(Type leftType, Type rightType)
            {
                this.leftType = leftType;
                this.rightType = rightType;
            }

            public bool Equals(OperatorQuery other)
            {
                return
                    leftType == other.leftType &&
                    rightType == other.rightType;
            }

            public override bool Equals(object obj)
            {
                if (!(obj is OperatorQuery))
                {
                    return false;
                }

                return Equals((OperatorQuery)obj);
            }

            public override int GetHashCode()
            {
                return HashUtility.GetHashCode(leftType, rightType);
            }
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             namespace Unity.VisualScripting
{
    public sealed class DivisionHandler : BinaryOperatorHandler
    {
        public DivisionHandler() : base("Division", "Divide", "/", "op_Division")
        {
            Handle<byte, byte>((a, b) => a / b);
            Handle<byte, sbyte>((a, b) => a / b);
            Handle<byte, short>((a, b) => a / b);
            Handle<byte, ushort>((a, b) => a / b);
            Handle<byte, int>((a, b) => a / b);
            Handle<byte, uint>((a, b) => a / b);
            Handle<byte, long>((a, b) => a / b);
            Handle<byte, ulong>((a, b) => a / b);
            Handle<byte, float>((a, b) => a / b);
            Handle<byte, decimal>((a, b) => a / b);
            Handle<byte, double>((a, b) => a / b);

            Handle<sbyte, byte>((a, b) => a / b);
            Handle<sbyte, sbyte>((a, b) => a / b);
            Handle<sbyte, short>((a, b) => a / b);
            Handle<sbyte, ushort>((a, b) => a / b);
            Handle<sbyte, int>((a, b) => a / b);
            Handle<sbyte, uint>((a, b) => a / b);
            Handle<sbyte, long>((a, b) => a / b);
            //Handle<sbyte, ulong>((a, b) => a / b);
            Handle<sbyte, float>((a, b) => a / b);
            Handle<sbyte, decimal>((a, b) => a / b);
            Handle<sbyte, double>((a, b) => a / b);

            Handle<short, byte>((a, b) => a / b);
            Handle<short, sbyte>((a, b) => a / b);
            Handle<short, short>((a, b) => a / b);
            Handle<short, ushort>((a, b) => a / b);
            Handle<short, int>((a, b) => a / b);
            Handle<short, uint>((a, b) => a / b);
            Handle<short, long>((a, b) => a / b);
            //Handle<short, ulong>((a, b) => a / b);
            Handle<short, float>((a, b) => a / b);
            Handle<short, decimal>((a, b) => a / b);
            Handle<short, double>((a, b) => a / b);

            Handle<ushort, byte>((a, b) => a / b);
            Handle<ushort, sbyte>((a, b) => a / b);
            Handle<ushort, short>((a, b) => a / b);
            Handle<ushort, ushort>((a, b) => a / b);
            Handle<ushort, int>((a, b) => a / b);
            Handle<ushort, uint>((a, b) => a / b);
            Handle<ushort, long>((a, b) => a / b);
            Handle<ushort, ulong>((a, b) => a / b);
            Handle<ushort, float>((a, b) => a / b);
            Handle<ushort, decimal>((a, b) => a / b);
            Handle<ushort, double>((a, b) => a / b);

            Handle<int, byte>((a, b) => a / b);
            Handle<int, sbyte>((a, b) => a / b);
            Handle<int, short>((a, b) => a / b);
            Handle<int, ushort>((a, b) => a / b);
            Handle<int, int>((a, b) => a / b);
            Handle<int, uint>((a, b) => a / b);
            Handle<int, long>((a, b) => a / b);
            //Handle<int, ulong>((a, b) => a / b);
            Handle<int, float>((a, b) => a / b);
            Handle<int, decimal>((a, b) => a / b);
            Handle<int, double>((a, b) => a / b);

            Handle<uint, byte>((a, b) => a / b);
            Handle<uint, sbyte>((a, b) => a / b);
            Handle<uint, short>((a, b) => a / b);
            Handle<uint, ushort>((a, b) => a / b);
            Handle<uint, int>((a, b) => a / b);
            Handle<uint, uint>((a, b) => a / b);
            Handle<uint, long>((a, b) => a / b);
            Handle<uint, ulong>((a, b) => a / b);
            Handle<uint, float>((a, b) => a / b);
            Handle<uint, decimal>((a, b) => a / b);
            Handle<uint, double>((a, b) => a / b);

            Handle<long, byte>((a, b) => a / b);
            Handle<long, sbyte>((a, b) => a / b);
            Handle<long, short>((a, b) => a / b);
            Handle<long, ushort>((a, b) => a / b);
            Handle<long, int>((a, b) => a / b);
            Handle<long, uint>((a, b) => a / b);
            Handle<long, long>((a, b) => a / b);
            //Handle<long, ulong>((a, b) => a / b);
            Handle<long, float>((a, b) => a / b);
            Handle<long, decimal>((a, b) => a / b);
            Handle<long, double>((a, b) => a / b);

            Handle<ulong, byte>((a, b) => a / b);
            //Handle<ulong, sbyte>((a, b) => a / b);
            //Handle<ulong, short>((a, b) => a / b);
            Handle<ulong, ushort>((a, b) => a / b);
            //Handle<ulong, int>((a, b) => a / b);
            Handle<ulong, uint>((a, b) => a / b);
            //Handle<ulong, long>((a, b) => a / b);
            Handle<ulong, ulong>((a, b) => a / b);
            Handle<ulong, float>((a, b) => a / b);
            Handle<ulong, decimal>((a, b) => a / b);
            Handle<ulong, double>((a, b) => a / b);

            Handle<float, byte>((a, b) => a / b);
            Handle<float, sbyte>((a, b) => a / b);
            Handle<float, short>((a, b) => a / b);
            Handle<float, ushort>((a, b) => a / b);
            Handle<float, int>((a, b) => a / b);
            Handle<float, uint>((a, b) => a / b);
            Handle<float, long>((a, b) => a / b);
            Handle<float, ulong>((a, b) => a / b);
            Handle<float, float>((a, b) => a / b);
            //Handle<float, decimal>((a, b) => a / b);
            Handle<float, double>((a, b) => a / b);

            Handle<decimal, byte>((a, b) => a / b);
            Handle<decimal, sbyte>((a, b) => a / b);
            Handle<decimal, short>((a, b) => a / b);
            Handle<decimal, ushort>((a, b) => a / b);
            Handle<decimal, int>((a, b) => a / b);
            Handle<decimal, uint>((a, b) => a / b);
            Handle<decimal, long>((a, b) => a / b);
            Handle<decimal, ulong>((a, b) => a / b);
            //Handle<decimal, float>((a, b) => a / b);
            Handle<decimal, decimal>((a, b) => a / b);
            //Handle<decimal, double>((a, b) => a / b);

            Handle<double, byte>((a, b) => a / b);
            Handle<double, sbyte>((a, b) => a / b);
            Handle<double, short>((a, b) => a / b);
            Handle<double, ushort>((a, b) => a / b);
            Handle<double, int>((a, b) => a / b);
            Handle<double, uint>((a, b) => a / b);
            Handle<double, long>((a, b) => a / b);
            Handle<double, ulong>((a, b) => a / b);
            Handle<double, float>((a, b) => a / b);
            //Handle<double, decimal>((a, b) => a / b);
            Handle<double, double>((a, b) => a / b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   using UnityEngine;

namespace Unity.VisualScripting
{
    public class EqualityHandler : BinaryOperatorHandler
    {
        public EqualityHandler() : base("Equality", "Equal", "==", "op_Equality")
        {
            Handle<byte, byte>((a, b) => a == b);
            Handle<byte, sbyte>((a, b) => a == b);
            Handle<byte, short>((a, b) => a == b);
            Handle<byte, ushort>((a, b) => a == b);
            Handle<byte, int>((a, b) => a == b);
            Handle<byte, uint>((a, b) => a == b);
            Handle<byte, long>((a, b) => a == b);
            Handle<byte, ulong>((a, b) => a == b);
            Handle<byte, float>((a, b) => a == b);
            Handle<byte, decimal>((a, b) => a == b);
            Handle<byte, double>((a, b) => a == b);

            Handle<sbyte, byte>((a, b) => a == b);
            Handle<sbyte, sbyte>((a, b) => a == b);
            Handle<sbyte, short>((a, b) => a == b);
            Handle<sbyte, ushort>((a, b) => a == b);
            Handle<sbyte, int>((a, b) => a == b);
            Handle<sbyte, uint>((a, b) => a == b);
            Handle<sbyte, long>((a, b) => a == b);
            //Handle<sbyte, ulong>((a, b) => a == b);
            Handle<sbyte, float>((a, b) => a == b);
            Handle<sbyte, decimal>((a, b) => a == b);
            Handle<sbyte, double>((a, b) => a == b);

            Handle<short, byte>((a, b) => a == b);
            Handle<short, sbyte>((a, b) => a == b);
            Handle<short, short>((a, b) => a == b);
            Handle<short, ushort>((a, b) => a == b);
            Handle<short, int>((a, b) => a == b);
            Handle<short, uint>((a, b) => a == b);
            Handle<short, long>((a, b) => a == b);
            //Handle<short, ulong>((a, b) => a == b);
            Handle<short, float>((a, b) => a == b);
            Handle<short, decimal>((a, b) => a == b);
            Handle<short, double>((a, b) => a == b);

            Handle<ushort, byte>((a, b) => a == b);
            Handle<ushort, sbyte>((a, b) => a == b);
            Handle<ushort, short>((a, b) => a == b);
            Handle<ushort, ushort>((a, b) => a == b);
            Handle<ushort, int>((a, b) => a == b);
            Handle<ushort, uint>((a, b) => a == b);
            Handle<ushort, long>((a, b) => a == b);
            Handle<ushort, ulong>((a, b) => a == b);
            Handle<ushort, float>((a, b) => a == b);
            Handle<ushort, decimal>((a, b) => a == b);
            Handle<ushort, double>((a, b) => a == b);

            Handle<int, byte>((a, b) => a == b);
            Handle<int, sbyte>((a, b) => a == b);
            Handle<int, short>((a, b) => a == b);
            Handle<int, ushort>((a, b) => a == b);
            Handle<int, int>((a, b) => a == b);
            Handle<int, uint>((a, b) => a == b);
            Handle<int, long>((a, b) => a == b);
            //Handle<int, ulong>((a, b) => a == b);
            Handle<int, float>((a, b) => a == b);
            Handle<int, decimal>((a, b) => a == b);
            Handle<int, double>((a, b) => a == b);

            Handle<uint, byte>((a, b) => a == b);
            Handle<uint, sbyte>((a, b) => a == b);
            Handle<uint, short>((a, b) => a == b);
            Handle<uint, ushort>((a, b) => a == b);
            Handle<uint, int>((a, b) => a == b);
            Handle<uint, uint>((a, b) => a == b);
            Handle<uint, long>((a, b) => a == b);
            Handle<uint, ulong>((a, b) => a == b);
            Handle<uint, float>((a, b) => a == b);
            Handle<uint, decimal>((a, b) => a == b);
            Handle<uint, double>((a, b) => a == b);

            Handle<long, byte>((a, b) => a == b);
            Handle<long, sbyte>((a, b) => a == b);
            Handle<long, short>((a, b) => a == b);
            Handle<long, ushort>((a, b) => a == b);
            Handle<long, int>((a, b) => a == b);
            Handle<long, uint>((a, b) => a == b);
            Handle<long, long>((a, b) => a == b);
            //Handle<long, ulong>((a, b) => a == b);
            Handle<long, float>((a, b) => a == b);
            Handle<long, decimal>((a, b) => a == b);
            Handle<long, double>((a, b) => a == b);

            Handle<ulong, byte>((a, b) => a == b);
            //Handle<ulong, sbyte>((a, b) => a == b);
            //Handle<ulong, short>((a, b) => a == b);
            Handle<ulong, ushort>((a, b) => a == b);
            //Handle<ulong, int>((a, b) => a == b);
            Handle<ulong, uint>((a, b) => a == b);
            //Handle<ulong, long>((a, b) => a == b);
            Handle<ulong, ulong>((a, b) => a == b);
            Handle<ulong, float>((a, b) => a == b);
            Handle<ulong, decimal>((a, b) => a == b);
            Handle<ulong, double>((a, b) => a == b);

            Handle<float, byte>((a, b) => a == b);
            Handle<float, sbyte>((a, b) => a == b);
            Handle<float, short>((a, b) => a == b);
            Handle<float, ushort>((a, b) => a == b);
            Handle<float, int>((a, b) => a == b);
            Handle<float, uint>((a, b) => a == b);
            Handle<float, long>((a, b) => a == b);
            Handle<float, ulong>((a, b) => a == b);
            Handle<float, float>((a, b) => Mathf.Approximately(a, b));
            //Handle<float, decimal>((a, b) => a == b);
            Handle<float, double>((a, b) => a == b);

            Handle<decimal, byte>((a, b) => a == b);
            Handle<decimal, sbyte>((a, b) => a == b);
            Handle<decimal, short>((a, b) => a == b);
            Handle<decimal, ushort>((a, b) => a == b);
            Handle<decimal, int>((a, b) => a == b);
            Handle<decimal, uint>((a, b) => a == b);
            Handle<decimal, long>((a, b) => a == b);
            Handle<decimal, ulong>((a, b) => a == b);
            //Handle<decimal, float>((a, b) => a == b);
            Handle<decimal, decimal>((a, b) => a == b);
            //Handle<decimal, double>((a, b) => a == b);

            Handle<double, byte>((a, b) => a == b);
            Handle<double, sbyte>((a, b) => a == b);
            Handle<double, short>((a, b) => a == b);
            Handle<double, ushort>((a, b) => a == b);
            Handle<double, int>((a, b) => a == b);
            Handle<double, uint>((a, b) => a == b);
            Handle<double, long>((a, b) => a == b);
            Handle<double, ulong>((a, b) => a == b);
            Handle<double, float>((a, b) => a == b);
            //Handle<double, decimal>((a, b) => a == b);
            Handle<double, double>((a, b) => a == b);
        }

        protected override object BothNullHandling()
        {
            return true;
        }

        protected override object SingleNullHandling()
        {
            return false;
        }

        protected override object CustomHandling(object leftOperand, object rightOperand)
        {
            return Equals(leftOperand, rightOperand);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            namespace Unity.VisualScripting
{
    public class GreaterThanHandler : BinaryOperatorHandler
    {
        public GreaterThanHandler() : base("Greather Than", "Greather Than", ">", "op_GreaterThan")
        {
            Handle<byte, byte>((a, b) => a > b);
            Handle<byte, sbyte>((a, b) => a > b);
            Handle<byte, short>((a, b) => a > b);
            Handle<byte, ushort>((a, b) => a > b);
            Handle<byte, int>((a, b) => a > b);
            Handle<byte, uint>((a, b) => a > b);
            Handle<byte, long>((a, b) => a > b);
            Handle<byte, ulong>((a, b) => a > b);
            Handle<byte, float>((a, b) => a > b);
            Handle<byte, decimal>((a, b) => a > b);
            Handle<byte, double>((a, b) => a > b);

            Handle<sbyte, byte>((a, b) => a > b);
            Handle<sbyte, sbyte>((a, b) => a > b);
            Handle<sbyte, short>((a, b) => a > b);
            Handle<sbyte, ushort>((a, b) => a > b);
            Handle<sbyte, int>((a, b) => a > b);
            Handle<sbyte, uint>((a, b) => a > b);
            Handle<sbyte, long>((a, b) => a > b);
            //Handle<sbyte, ulong>((a, b) => a > b);
            Handle<sbyte, float>((a, b) => a > b);
            Handle<sbyte, decimal>((a, b) => a > b);
            Handle<sbyte, double>((a, b) => a > b);

            Handle<short, byte>((a, b) => a > b);
            Handle<short, sbyte>((a, b) => a > b);
            Handle<short, short>((a, b) => a > b);
            Handle<short, ushort>((a, b) => a > b);
            Handle<short, int>((a, b) => a > b);
            Handle<short, uint>((a, b) => a > b);
            Handle<short, long>((a, b) => a > b);
            //Handle<short, ulong>((a, b) => a > b);
            Handle<short, float>((a, b) => a > b);
            Handle<short, decimal>((a, b) => a > b);
            Handle<short, double>((a, b) => a > b);

            Handle<ushort, byte>((a, b) => a > b);
            Handle<ushort, sbyte>((a, b) => a > b);
            Handle<ushort, short>((a, b) => a > b);
            Handle<ushort, ushort>((a, b) => a > b);
            Handle<ushort, int>((a, b) => a > b);
            Handle<ushort, uint>((a, b) => a > b);
            Handle<ushort, long>((a, b) => a > b);
            Handle<ushort, ulong>((a, b) => a > b);
            Handle<ushort, float>((a, b) => a > b);
            Handle<ushort, decimal>((a, b) => a > b);
            Handle<ushort, double>((a, b) => a > b);

            Handle<int, byte>((a, b) => a > b);
            Handle<int, sbyte>((a, b) => a > b);
            Handle<int, short>((a, b) => a > b);
            Handle<int, ushort>((a, b) => a > b);
            Handle<int, int>((a, b) => a > b);
            Handle<int, uint>((a, b) => a > b);
            Handle<int, long>((a, b) => a > b);
            //Handle<int, ulong>((a, b) => a > b);
            Handle<int, float>((a, b) => a > b);
            Handle<int, decimal>((a, b) => a > b);
            Handle<int, double>((a, b) => a > b);

            Handle<uint, byte>((a, b) => a > b);
            Handle<uint, sbyte>((a, b) => a > b);
            Handle<uint, short>((a, b) => a > b);
            Handle<uint, ushort>((a, b) => a > b);
            Handle<uint, int>((a, b) => a > b);
            Handle<uint, uint>((a, b) => a > b);
            Handle<uint, long>((a, b) => a > b);
            Handle<uint, ulong>((a, b) => a > b);
            Handle<uint, float>((a, b) => a > b);
            Handle<uint, decimal>((a, b) => a > b);
            Handle<uint, double>((a, b) => a > b);

            Handle<long, byte>((a, b) => a > b);
            Handle<long, sbyte>((a, b) => a > b);
            Handle<long, short>((a, b) => a > b);
            Handle<long, ushort>((a, b) => a > b);
            Handle<long, int>((a, b) => a > b);
            Handle<long, uint>((a, b) => a > b);
            Handle<long, long>((a, b) => a > b);
            //Handle<long, ulong>((a, b) => a > b);
            Handle<long, float>((a, b) => a > b);
            Handle<long, decimal>((a, b) => a > b);
            Handle<long, double>((a, b) => a > b);

            Handle<ulong, byte>((a, b) => a > b);
            //Handle<ulong, sbyte>((a, b) => a > b);
            //Handle<ulong, short>((a, b) => a > b);
            Handle<ulong, ushort>((a, b) => a > b);
            //Handle<ulong, int>((a, b) => a > b);
            Handle<ulong, uint>((a, b) => a > b);
            //Handle<ulong, long>((a, b) => a > b);
            Handle<ulong, ulong>((a, b) => a > b);
            Handle<ulong, float>((a, b) => a > b);
            Handle<ulong, decimal>((a, b) => a > b);
            Handle<ulong, double>((a, b) => a > b);

            Handle<float, byte>((a, b) => a > b);
            Handle<float, sbyte>((a, b) => a > b);
            Handle<float, short>((a, b) => a > b);
            Handle<float, ushort>((a, b) => a > b);
            Handle<float, int>((a, b) => a > b);
            Handle<float, uint>((a, b) => a > b);
            Handle<float, long>((a, b) => a > b);
            Handle<float, ulong>((a, b) => a > b);
            Handle<float, float>((a, b) => a > b);
            //Handle<float, decimal>((a, b) => a > b);
            Handle<float, double>((a, b) => a > b);

            Handle<decimal, byte>((a, b) => a > b);
            Handle<decimal, sbyte>((a, b) => a > b);
            Handle<decimal, short>((a, b) => a > b);
            Handle<decimal, ushort>((a, b) => a > b);
            Handle<decimal, int>((a, b) => a > b);
            Handle<decimal, uint>((a, b) => a > b);
            Handle<decimal, long>((a, b) => a > b);
            Handle<decimal, ulong>((a, b) => a > b);
            //Handle<decimal, float>((a, b) => a > b);
            Handle<decimal, decimal>((a, b) => a > b);
            //Handle<decimal, double>((a, b) => a > b);

            Handle<double, byte>((a, b) => a > b);
            Handle<double, sbyte>((a, b) => a > b);
            Handle<double, short>((a, b) => a > b);
            Handle<double, ushort>((a, b) => a > b);
            Handle<double, int>((a, b) => a > b);
            Handle<double, uint>((a, b) => a > b);
            Handle<double, long>((a, b) => a > b);
            Handle<double, ulong>((a, b) => a > b);
            Handle<double, float>((a, b) => a > b);
            //Handle<double, decimal>((a, b) => a > b);
            Handle<double, double>((a, b) => a > b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     using UnityEngine;

namespace Unity.VisualScripting
{
    public class GreaterThanOrEqualHandler : BinaryOperatorHandler
    {
        public GreaterThanOrEqualHandler() : base("Greater Than Or Equal", "Greater Than Or Equal", ">=", "op_GreaterThanOrEqual")
        {
            Handle<byte, byte>((a, b) => a >= b);
            Handle<byte, sbyte>((a, b) => a >= b);
            Handle<byte, short>((a, b) => a >= b);
            Handle<byte, ushort>((a, b) => a >= b);
            Handle<byte, int>((a, b) => a >= b);
            Handle<byte, uint>((a, b) => a >= b);
            Handle<byte, long>((a, b) => a >= b);
            Handle<byte, ulong>((a, b) => a >= b);
            Handle<byte, float>((a, b) => a >= b);
            Handle<byte, decimal>((a, b) => a >= b);
            Handle<byte, double>((a, b) => a >= b);

            Handle<sbyte, byte>((a, b) => a >= b);
            Handle<sbyte, sbyte>((a, b) => a >= b);
            Handle<sbyte, short>((a, b) => a >= b);
            Handle<sbyte, ushort>((a, b) => a >= b);
            Handle<sbyte, int>((a, b) => a >= b);
            Handle<sbyte, uint>((a, b) => a >= b);
            Handle<sbyte, long>((a, b) => a >= b);
            //Handle<sbyte, ulong>((a, b) => a >= b);
            Handle<sbyte, float>((a, b) => a >= b);
            Handle<sbyte, decimal>((a, b) => a >= b);
            Handle<sbyte, double>((a, b) => a >= b);

            Handle<short, byte>((a, b) => a >= b);
            Handle<short, sbyte>((a, b) => a >= b);
            Handle<short, short>((a, b) => a >= b);
            Handle<short, ushort>((a, b) => a >= b);
            Handle<short, int>((a, b) => a >= b);
            Handle<short, uint>((a, b) => a >= b);
            Handle<short, long>((a, b) => a >= b);
            //Handle<short, ulong>((a, b) => a >= b);
            Handle<short, float>((a, b) => a >= b);
            Handle<short, decimal>((a, b) => a >= b);
            Handle<short, double>((a, b) => a >= b);

            Handle<ushort, byte>((a, b) => a >= b);
            Handle<ushort, sbyte>((a, b) => a >= b);
            Handle<ushort, short>((a, b) => a >= b);
            Handle<ushort, ushort>((a, b) => a >= b);
            Handle<ushort, int>((a, b) => a >= b);
            Handle<ushort, uint>((a, b) => a >= b);
            Handle<ushort, long>((a, b) => a >= b);
            Handle<ushort, ulong>((a, b) => a >= b);
            Handle<ushort, float>((a, b) => a >= b);
            Handle<ushort, decimal>((a, b) => a >= b);
            Handle<ushort, double>((a, b) => a >= b);

            Handle<int, byte>((a, b) => a >= b);
            Handle<int, sbyte>((a, b) => a >= b);
            Handle<int, short>((a, b) => a >= b);
            Handle<int, ushort>((a, b) => a >= b);
            Handle<int, int>((a, b) => a >= b);
            Handle<int, uint>((a, b) => a >= b);
            Handle<int, long>((a, b) => a >= b);
            //Handle<int, ulong>((a, b) => a >= b);
            Handle<int, float>((a, b) => a >= b);
            Handle<int, decimal>((a, b) => a >= b);
            Handle<int, double>((a, b) => a >= b);

            Handle<uint, byte>((a, b) => a >= b);
            Handle<uint, sbyte>((a, b) => a >= b);
            Handle<uint, short>((a, b) => a >= b);
            Handle<uint, ushort>((a, b) => a >= b);
            Handle<uint, int>((a, b) => a >= b);
            Handle<uint, uint>((a, b) => a >= b);
            Handle<uint, long>((a, b) => a >= b);
            Handle<uint, ulong>((a, b) => a >= b);
            Handle<uint, float>((a, b) => a >= b);
            Handle<uint, decimal>((a, b) => a >= b);
            Handle<uint, double>((a, b) => a >= b);

            Handle<long, byte>((a, b) => a >= b);
            Handle<long, sbyte>((a, b) => a >= b);
            Handle<long, short>((a, b) => a >= b);
            Handle<long, ushort>((a, b) => a >= b);
            Handle<long, int>((a, b) => a >= b);
            Handle<long, uint>((a, b) => a >= b);
            Handle<long, long>((a, b) => a >= b);
            //Handle<long, ulong>((a, b) => a >= b);
            Handle<long, float>((a, b) => a >= b);
            Handle<long, decimal>((a, b) => a >= b);
            Handle<long, double>((a, b) => a >= b);

            Handle<ulong, byte>((a, b) => a >= b);
            //Handle<ulong, sbyte>((a, b) => a >= b);
            //Handle<ulong, short>((a, b) => a >= b);
            Handle<ulong, ushort>((a, b) => a >= b);
            //Handle<ulong, int>((a, b) => a >= b);
            Handle<ulong, uint>((a, b) => a >= b);
            //Handle<ulong, long>((a, b) => a >= b);
            Handle<ulong, ulong>((a, b) => a >= b);
            Handle<ulong, float>((a, b) => a >= b);
            Handle<ulong, decimal>((a, b) => a >= b);
            Handle<ulong, double>((a, b) => a >= b);

            Handle<float, byte>((a, b) => a >= b);
            Handle<float, sbyte>((a, b) => a >= b);
            Handle<float, short>((a, b) => a >= b);
            Handle<float, ushort>((a, b) => a >= b);
            Handle<float, int>((a, b) => a >= b);
            Handle<float, uint>((a, b) => a >= b);
            Handle<float, long>((a, b) => a >= b);
            Handle<float, ulong>((a, b) => a >= b);
            Handle<float, float>((a, b) => a >= b || Mathf.Approximately(a, b));
            //Handle<float, decimal>((a, b) => a >= b);
            Handle<float, double>((a, b) => a >= b);

            Handle<decimal, byte>((a, b) => a >= b);
            Handle<decimal, sbyte>((a, b) => a >= b);
            Handle<decimal, short>((a, b) => a >= b);
            Handle<decimal, ushort>((a, b) => a >= b);
            Handle<decimal, int>((a, b) => a >= b);
            Handle<decimal, uint>((a, b) => a >= b);
            Handle<decimal, long>((a, b) => a >= b);
            Handle<decimal, ulong>((a, b) => a >= b);
            //Handle<decimal, float>((a, b) => a >= b);
            Handle<decimal, decimal>((a, b) => a >= b);
            //Handle<decimal, double>((a, b) => a >= b);

            Handle<double, byte>((a, b) => a >= b);
            Handle<double, sbyte>((a, b) => a >= b);
            Handle<double, short>((a, b) => a >= b);
            Handle<double, ushort>((a, b) => a >= b);
            Handle<double, int>((a, b) => a >= b);
            Handle<double, uint>((a, b) => a >= b);
            Handle<double, long>((a, b) => a >= b);
            Handle<double, ulong>((a, b) => a >= b);
            Handle<double, float>((a, b) => a >= b);
            //Handle<double, decimal>((a, b) => a >= b);
            Handle<double, double>((a, b) => a >= b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     using UnityEngine;

namespace Unity.VisualScripting
{
    public class InequalityHandler : BinaryOperatorHandler
    {
        public InequalityHandler() : base("Inequality", "Not Equal", "!=", "op_Inequality")
        {
            Handle<byte, byte>((a, b) => a != b);
            Handle<byte, sbyte>((a, b) => a != b);
            Handle<byte, short>((a, b) => a != b);
            Handle<byte, ushort>((a, b) => a != b);
            Handle<byte, int>((a, b) => a != b);
            Handle<byte, uint>((a, b) => a != b);
            Handle<byte, long>((a, b) => a != b);
            Handle<byte, ulong>((a, b) => a != b);
            Handle<byte, float>((a, b) => a != b);
            Handle<byte, decimal>((a, b) => a != b);
            Handle<byte, double>((a, b) => a != b);

            Handle<sbyte, byte>((a, b) => a != b);
            Handle<sbyte, sbyte>((a, b) => a != b);
            Handle<sbyte, short>((a, b) => a != b);
            Handle<sbyte, ushort>((a, b) => a != b);
            Handle<sbyte, int>((a, b) => a != b);
            Handle<sbyte, uint>((a, b) => a != b);
            Handle<sbyte, long>((a, b) => a != b);
            //Handle<sbyte, ulong>((a, b) => a != b);
            Handle<sbyte, float>((a, b) => a != b);
            Handle<sbyte, decimal>((a, b) => a != b);
            Handle<sbyte, double>((a, b) => a != b);

            Handle<short, byte>((a, b) => a != b);
            Handle<short, sbyte>((a, b) => a != b);
            Handle<short, short>((a, b) => a != b);
            Handle<short, ushort>((a, b) => a != b);
            Handle<short, int>((a, b) => a != b);
            Handle<short, uint>((a, b) => a != b);
            Handle<short, long>((a, b) => a != b);
            //Handle<short, ulong>((a, b) => a != b);
            Handle<short, float>((a, b) => a != b);
            Handle<short, decimal>((a, b) => a != b);
            Handle<short, double>((a, b) => a != b);

            Handle<ushort, byte>((a, b) => a != b);
            Handle<ushort, sbyte>((a, b) => a != b);
            Handle<ushort, short>((a, b) => a != b);
            Handle<ushort, ushort>((a, b) => a != b);
            Handle<ushort, int>((a, b) => a != b);
            Handle<ushort, uint>((a, b) => a != b);
            Handle<ushort, long>((a, b) => a != b);
            Handle<ushort, ulong>((a, b) => a != b);
            Handle<ushort, float>((a, b) => a != b);
            Handle<ushort, decimal>((a, b) => a != b);
            Handle<ushort, double>((a, b) => a != b);

            Handle<int, byte>((a, b) => a != b);
            Handle<int, sbyte>((a, b) => a != b);
            Handle<int, short>((a, b) => a != b);
            Handle<int, ushort>((a, b) => a != b);
            Handle<int, int>((a, b) => a != b);
            Handle<int, uint>((a, b) => a != b);
            Handle<int, long>((a, b) => a != b);
            //Handle<int, ulong>((a, b) => a != b);
            Handle<int, float>((a, b) => a != b);
            Handle<int, decimal>((a, b) => a != b);
            Handle<int, double>((a, b) => a != b);

            Handle<uint, byte>((a, b) => a != b);
            Handle<uint, sbyte>((a, b) => a != b);
            Handle<uint, short>((a, b) => a != b);
            Handle<uint, ushort>((a, b) => a != b);
            Handle<uint, int>((a, b) => a != b);
            Handle<uint, uint>((a, b) => a != b);
            Handle<uint, long>((a, b) => a != b);
            Handle<uint, ulong>((a, b) => a != b);
            Handle<uint, float>((a, b) => a != b);
            Handle<uint, decimal>((a, b) => a != b);
            Handle<uint, double>((a, b) => a != b);

            Handle<long, byte>((a, b) => a != b);
            Handle<long, sbyte>((a, b) => a != b);
            Handle<long, short>((a, b) => a != b);
            Handle<long, ushort>((a, b) => a != b);
            Handle<long, int>((a, b) => a != b);
            Handle<long, uint>((a, b) => a != b);
            Handle<long, long>((a, b) => a != b);
            //Handle<long, ulong>((a, b) => a != b);
            Handle<long, float>((a, b) => a != b);
            Handle<long, decimal>((a, b) => a != b);
            Handle<long, double>((a, b) => a != b);

            Handle<ulong, byte>((a, b) => a != b);
            //Handle<ulong, sbyte>((a, b) => a != b);
            //Handle<ulong, short>((a, b) => a != b);
            Handle<ulong, ushort>((a, b) => a != b);
            //Handle<ulong, int>((a, b) => a != b);
            Handle<ulong, uint>((a, b) => a != b);
            //Handle<ulong, long>((a, b) => a != b);
            Handle<ulong, ulong>((a, b) => a != b);
            Handle<ulong, float>((a, b) => a != b);
            Handle<ulong, decimal>((a, b) => a != b);
            Handle<ulong, double>((a, b) => a != b);

            Handle<float, byte>((a, b) => a != b);
            Handle<float, sbyte>((a, b) => a != b);
            Handle<float, short>((a, b) => a != b);
            Handle<float, ushort>((a, b) => a != b);
            Handle<float, int>((a, b) => a != b);
            Handle<float, uint>((a, b) => a != b);
            Handle<float, long>((a, b) => a != b);
            Handle<float, ulong>((a, b) => a != b);
            Handle<float, float>((a, b) => !Mathf.Approximately(a, b));
            //Handle<float, decimal>((a, b) => a != b);
            Handle<float, double>((a, b) => a != b);

            Handle<decimal, byte>((a, b) => a != b);
            Handle<decimal, sbyte>((a, b) => a != b);
            Handle<decimal, short>((a, b) => a != b);
            Handle<decimal, ushort>((a, b) => a != b);
            Handle<decimal, int>((a, b) => a != b);
            Handle<decimal, uint>((a, b) => a != b);
            Handle<decimal, long>((a, b) => a != b);
            Handle<decimal, ulong>((a, b) => a != b);
            //Handle<decimal, float>((a, b) => a != b);
            Handle<decimal, decimal>((a, b) => a != b);
            //Handle<decimal, double>((a, b) => a != b);

            Handle<double, byte>((a, b) => a != b);
            Handle<double, sbyte>((a, b) => a != b);
            Handle<double, short>((a, b) => a != b);
            Handle<double, ushort>((a, b) => a != b);
            Handle<double, int>((a, b) => a != b);
            Handle<double, uint>((a, b) => a != b);
            Handle<double, long>((a, b) => a != b);
            Handle<double, ulong>((a, b) => a != b);
            Handle<double, float>((a, b) => a != b);
            //Handle<double, decimal>((a, b) => a != b);
            Handle<double, double>((a, b) => a != b);
        }

        protected override object BothNullHandling()
        {
            return false;
        }

        protected override object SingleNullHandling()
        {
            return false;
        }

        protected override object CustomHandling(object leftOperand, object rightOperand)
        {
            return !Equals(leftOperand, rightOperand);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             namespace Unity.VisualScripting
{
    public class LessThanHandler : BinaryOperatorHandler
    {
        public LessThanHandler() : base("Less Than", "Less Than", "<", "op_LessThan")
        {
            Handle<byte, byte>((a, b) => a < b);
            Handle<byte, sbyte>((a, b) => a < b);
            Handle<byte, short>((a, b) => a < b);
            Handle<byte, ushort>((a, b) => a < b);
            Handle<byte, int>((a, b) => a < b);
            Handle<byte, uint>((a, b) => a < b);
            Handle<byte, long>((a, b) => a < b);
            Handle<byte, ulong>((a, b) => a < b);
            Handle<byte, float>((a, b) => a < b);
            Handle<byte, decimal>((a, b) => a < b);
            Handle<byte, double>((a, b) => a < b);

            Handle<sbyte, byte>((a, b) => a < b);
            Handle<sbyte, sbyte>((a, b) => a < b);
            Handle<sbyte, short>((a, b) => a < b);
            Handle<sbyte, ushort>((a, b) => a < b);
            Handle<sbyte, int>((a, b) => a < b);
            Handle<sbyte, uint>((a, b) => a < b);
            Handle<sbyte, long>((a, b) => a < b);
            //Handle<sbyte, ulong>((a, b) => a < b);
            Handle<sbyte, float>((a, b) => a < b);
            Handle<sbyte, decimal>((a, b) => a < b);
            Handle<sbyte, double>((a, b) => a < b);

            Handle<short, byte>((a, b) => a < b);
            Handle<short, sbyte>((a, b) => a < b);
            Handle<short, short>((a, b) => a < b);
            Handle<short, ushort>((a, b) => a < b);
            Handle<short, int>((a, b) => a < b);
            Handle<short, uint>((a, b) => a < b);
            Handle<short, long>((a, b) => a < b);
            //Handle<short, ulong>((a, b) => a < b);
            Handle<short, float>((a, b) => a < b);
            Handle<short, decimal>((a, b) => a < b);
            Handle<short, double>((a, b) => a < b);

            Handle<ushort, byte>((a, b) => a < b);
            Handle<ushort, sbyte>((a, b) => a < b);
            Handle<ushort, short>((a, b) => a < b);
            Handle<ushort, ushort>((a, b) => a < b);
            Handle<ushort, int>((a, b) => a < b);
            Handle<ushort, uint>((a, b) => a < b);
            Handle<ushort, long>((a, b) => a < b);
            Handle<ushort, ulong>((a, b) => a < b);
            Handle<ushort, float>((a, b) => a < b);
            Handle<ushort, decimal>((a, b) => a < b);
            Handle<ushort, double>((a, b) => a < b);

            Handle<int, byte>((a, b) => a < b);
            Handle<int, sbyte>((a, b) => a < b);
            Handle<int, short>((a, b) => a < b);
            Handle<int, ushort>((a, b) => a < b);
            Handle<int, int>((a, b) => a < b);
            Handle<int, uint>((a, b) => a < b);
            Handle<int, long>((a, b) => a < b);
            //Handle<int, ulong>((a, b) => a < b);
            Handle<int, float>((a, b) => a < b);
            Handle<int, decimal>((a, b) => a < b);
            Handle<int, double>((a, b) => a < b);

            Handle<uint, byte>((a, b) => a < b);
            Handle<uint, sbyte>((a, b) => a < b);
            Handle<uint, short>((a, b) => a < b);
            Handle<uint, ushort>((a, b) => a < b);
            Handle<uint, int>((a, b) => a < b);
            Handle<uint, uint>((a, b) => a < b);
            Handle<uint, long>((a, b) => a < b);
            Handle<uint, ulong>((a, b) => a < b);
            Handle<uint, float>((a, b) => a < b);
            Handle<uint, decimal>((a, b) => a < b);
            Handle<uint, double>((a, b) => a < b);

            Handle<long, byte>((a, b) => a < b);
            Handle<long, sbyte>((a, b) => a < b);
            Handle<long, short>((a, b) => a < b);
            Handle<long, ushort>((a, b) => a < b);
            Handle<long, int>((a, b) => a < b);
            Handle<long, uint>((a, b) => a < b);
            Handle<long, long>((a, b) => a < b);
            //Handle<long, ulong>((a, b) => a < b);
            Handle<long, float>((a, b) => a < b);
            Handle<long, decimal>((a, b) => a < b);
            Handle<long, double>((a, b) => a < b);

            Handle<ulong, byte>((a, b) => a < b);
            //Handle<ulong, sbyte>((a, b) => a < b);
            //Handle<ulong, short>((a, b) => a < b);
            Handle<ulong, ushort>((a, b) => a < b);
            //Handle<ulong, int>((a, b) => a < b);
            Handle<ulong, uint>((a, b) => a < b);
            //Handle<ulong, long>((a, b) => a < b);
            Handle<ulong, ulong>((a, b) => a < b);
            Handle<ulong, float>((a, b) => a < b);
            Handle<ulong, decimal>((a, b) => a < b);
            Handle<ulong, double>((a, b) => a < b);

            Handle<float, byte>((a, b) => a < b);
            Handle<float, sbyte>((a, b) => a < b);
            Handle<float, short>((a, b) => a < b);
            Handle<float, ushort>((a, b) => a < b);
            Handle<float, int>((a, b) => a < b);
            Handle<float, uint>((a, b) => a < b);
            Handle<float, long>((a, b) => a < b);
            Handle<float, ulong>((a, b) => a < b);
            Handle<float, float>((a, b) => a < b);
            //Handle<float, decimal>((a, b) => a < b);
            Handle<float, double>((a, b) => a < b);

            Handle<decimal, byte>((a, b) => a < b);
            Handle<decimal, sbyte>((a, b) => a < b);
            Handle<decimal, short>((a, b) => a < b);
            Handle<decimal, ushort>((a, b) => a < b);
            Handle<decimal, int>((a, b) => a < b);
            Handle<decimal, uint>((a, b) => a < b);
            Handle<decimal, long>((a, b) => a < b);
            Handle<decimal, ulong>((a, b) => a < b);
            //Handle<decimal, float>((a, b) => a < b);
            Handle<decimal, decimal>((a, b) => a < b);
            //Handle<decimal, double>((a, b) => a < b);

            Handle<double, byte>((a, b) => a < b);
            Handle<double, sbyte>((a, b) => a < b);
            Handle<double, short>((a, b) => a < b);
            Handle<double, ushort>((a, b) => a < b);
            Handle<double, int>((a, b) => a < b);
            Handle<double, uint>((a, b) => a < b);
            Handle<double, long>((a, b) => a < b);
            Handle<double, ulong>((a, b) => a < b);
            Handle<double, float>((a, b) => a < b);
            //Handle<double, decimal>((a, b) => a < b);
            Handle<double, double>((a, b) => a < b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      INDX( 	 ÀÎR          (   ò  Ë       Ÿ  o a               ë    Ä l     ¢ò    √°£ÁÏŸ¿‹¯˙ùØŸ˜P
ÁÏŸ LÕ$ËÏŸ       ´               E x c l u s i v e O r H a n d l e r . c s . m ¥ò    à v     ¢ò    DCrY¿ÏŸ PõÓÇ§Ÿµ]Å¿‰ŸLlrY¿ÏŸ¯       Û                E x c l u s i v e O r H a n d l e r . c s . m e t a   µò    Ä l     ¢ò    9∏rY¿ÏŸ PõÓÇ§Ÿ	‡\Å¿‰Ÿ9∏rY¿ÏŸ                       G r e a t e r T h a n H a n d l e r . c s     ∂ò    à v     ¢ò    Î"sY¿ÏŸ PõÓÇ§Ÿ)R[Å¿‰ŸÎ"sY¿Ï ¯       Û                G r e a t e r T h a n H a n d l e r . c s . m e t a   ∑ò    ê z     ¢ò    ÍpsY¿ÏŸ PõÓÇ§ŸÔAZÅ¿‰Ÿ‡ósY¿ÏŸ        €               G r e a t e r T h a n O r E q u a l H a n d l e r . c s       ∏ò    ò Ñ     ¢ò    …ÂsY¿ÏŸ PõÓÇ§ŸﬂªXÅ¿‰Ÿ…ÂsY¿ÏŸ¯       Û               ! G r e a t e r T h a n O r E q u a l H a n d l e r . c s . m e t a     ˝ê    x h     ¢ò    qY¢ÁÏŸ y˘˙ùØŸ ˜
ÁÏŸ LÕ$ËÏŸx      s               I n c r e m e n t H a n d l e r . c s ∫ò    à r    ¢ò    ΩêtY¿ÏŸ PõÓÇ§ŸuöVÅ¿‰Ÿ¡∑tY¿ÏŸ¯       Û                I n c r e m e n t H a n d l e r . c s . m e t a       ªò    Ä j     ¢ò    fÙtY¿ÏŸ PõÓÇ§Ÿ^<UÅ¿‰ŸmuY¿ÏŸ                       I n e q u a l i t y H a n d l e r . c s       ºò    à t     ¢ò    TiuY¿ÏŸ PõÓÇ§ŸKèSÅ¿‰ŸósuY¿ÏŸ¯       Û                I n e q u a l i t y H a n d l e r . c s . m e t a      ë    à x     ¢ò    ﬁÄ¢ÁÏŸP<˙˙ùØŸ ˜
ÁÏŸ%Õ$ËÏŸ                      I n v a l i d O p e r a t o r E x c e p t i  n . c s æò    ò Ç     ¢ò    n1vY¿ÏŸ PõÓÇ§Ÿ…•QÅ¿‰Ÿñ>vY¿ÏŸ¯       Û                 I n v a l i d O p e r a t o r E x c e p t i o n . c s . m e t a       ë    x h     ¢ò    ËÓ¢ÁÏŸêÿ˙˙ùØŸ˜P
ÁÏŸhÕ$ËÏŸ       ‹               L e f t S h i f t H a n d l e r . c s ¿ò    à r     ¢ò    ﬂÏvY¿ÏŸ PõÓÇ§Ÿ^{OÅ¿‰Ÿµ¯vY¿ÏŸ¯       Û                L e f t S h i f t H a n d l e r . c s . m e t a                     ¢ò    ıDwY¿ÏŸ PõÓÇ§Ÿ≥CNÅ¿‰Ÿ7bwY¿ÏŸ        ˙               L e s s T h  n H a n d l e r . c s   ¬ò    Ä p     ¢ò    ®°wY¿ÏŸ PõÓÇ§Ÿ óLÅ¿‰Ÿ¨»wY¿ÏŸ¯       Û                L e s s T h a n H a n d l e r . c s . m e t a √ò    à t     ¢ò    jxY¿ÏŸ PõÓÇ§Ÿb_KÅ¿‰Ÿm+xY¿ÏŸ        Ã               L e s s T h a n O r E q u a l H a n d l e r . c s     ƒò    ê ~     ¢ò    ~ÅxY¿ÏŸ PõÓÇ§Ÿ˛≤IÅ¿‰ŸtåxY¿ÏŸ¯       Û                L e s s T h a n O r E q u a l H a n d l e r . c s . m e t a   ≈ò    à t     ¢ò    Ü€xY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸÜ€xY¿ÏŸ0      -              L o g i c a l N e g a t i o n H a n d l e r . c s     ∆ò    ê ~     ¢ò    ¬'yY¿ÏŸ PõÓÇ§ŸëGÅ¿‰ŸOyY¿ÏŸ¯       Û                L o g i c a l N e g a t i o n H a n d l e r . c s . m e t a   «ò    x b     ¢ò    üyY¿ÏŸ PõÓÇ§ŸOÄFÅ¿‰ŸüyY¿ÏŸ        ˆ               M o d u l o H a n d l e r . c s       »ò    Ä l     ¢ò    ÌyY¿ÏŸ PõÓÇ§ŸÕΩDÅ¿‰Ÿ_zY¿ÏŸ¯       Û                M o d u l o H a n d l e r . c s . m e t a     …ò    à r     ¢ò    ∑dzY¿ÏŸ PõÓÇ§Ÿ≠CÅ¿‰Ÿ∑dzY¿ÏŸ                      M u l t i p l i c a t i o n H a n d l e r . c s        ò    ê |     ¢ò    ÌòzY¿ÏŸ PõÓÇ§Ÿ¯BÅ¿‰Ÿ*¿zY¿ÏŸ¯       Û                M u l t i p l i c a t i o n H a n d l e r . c s . m e t a     Àò    à t     ¢ò    õ˘zY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸû {Y¿ÏŸÄ      }               N u m e r i c N e g a t i o n H a n d l e r . c s     Ãò    ê ~     ¢ò    ãn{Y¿ÏŸ PõÓÇ§Ÿõô?Å¿‰Ÿãn{Y¿ÏŸ¯       Û                N u m e r i c N e g a t i o n H a n d l e r . c s . m e t a   Õò    Ä j    ¢ò    o∑{Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸuﬁ{Y¿ÏŸp      o               O p e r a t o r E x c e p t i o n . c s       Œò    à t     ¢ò    ∫|Y¿ÏŸ PõÓÇ§ŸXã=Å¿‰Ÿæ:|Y¿ÏŸ¯       Û                O p e r a t o r E x c e p t i o n . c s . m e t a     œò    x f     ¢ò    ãr|Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸû|Y¿ÏŸ∞      Ø               O p e r a t o r H a n d l e r . c s   –ò    Ä p     ¢ò    /ı|Y¿ÏŸ PõÓÇ§ŸÁi;Å¿‰Ÿ/ı|Y¿ÏŸ¯       Û                O p e r a t o r H a n d l e r . c s . m e t a              using UnityEngine;

namespace Unity.VisualScripting
{
    public class LessThanOrEqualHandler : BinaryOperatorHandler
    {
        public LessThanOrEqualHandler() : base("Less Than Or Equal", "Less Than Or Equal", ">=", "op_LessThanOrEqual")
        {
            Handle<byte, byte>((a, b) => a <= b);
            Handle<byte, sbyte>((a, b) => a <= b);
            Handle<byte, short>((a, b) => a <= b);
            Handle<byte, ushort>((a, b) => a <= b);
            Handle<byte, int>((a, b) => a <= b);
            Handle<byte, uint>((a, b) => a <= b);
            Handle<byte, long>((a, b) => a <= b);
            Handle<byte, ulong>((a, b) => a <= b);
            Handle<byte, float>((a, b) => a <= b);
            Handle<byte, decimal>((a, b) => a <= b);
            Handle<byte, double>((a, b) => a <= b);

            Handle<sbyte, byte>((a, b) => a <= b);
            Handle<sbyte, sbyte>((a, b) => a <= b);
            Handle<sbyte, short>((a, b) => a <= b);
            Handle<sbyte, ushort>((a, b) => a <= b);
            Handle<sbyte, int>((a, b) => a <= b);
            Handle<sbyte, uint>((a, b) => a <= b);
            Handle<sbyte, long>((a, b) => a <= b);
            //Handle<sbyte, ulong>((a, b) => a <= b);
            Handle<sbyte, float>((a, b) => a <= b);
            Handle<sbyte, decimal>((a, b) => a <= b);
            Handle<sbyte, double>((a, b) => a <= b);

            Handle<short, byte>((a, b) => a <= b);
            Handle<short, sbyte>((a, b) => a <= b);
            Handle<short, short>((a, b) => a <= b);
            Handle<short, ushort>((a, b) => a <= b);
            Handle<short, int>((a, b) => a <= b);
            Handle<short, uint>((a, b) => a <= b);
            Handle<short, long>((a, b) => a <= b);
            //Handle<short, ulong>((a, b) => a <= b);
            Handle<short, float>((a, b) => a <= b);
            Handle<short, decimal>((a, b) => a <= b);
            Handle<short, double>((a, b) => a <= b);

            Handle<ushort, byte>((a, b) => a <= b);
            Handle<ushort, sbyte>((a, b) => a <= b);
            Handle<ushort, short>((a, b) => a <= b);
            Handle<ushort, ushort>((a, b) => a <= b);
            Handle<ushort, int>((a, b) => a <= b);
            Handle<ushort, uint>((a, b) => a <= b);
            Handle<ushort, long>((a, b) => a <= b);
            Handle<ushort, ulong>((a, b) => a <= b);
            Handle<ushort, float>((a, b) => a <= b);
            Handle<ushort, decimal>((a, b) => a <= b);
            Handle<ushort, double>((a, b) => a <= b);

            Handle<int, byte>((a, b) => a <= b);
            Handle<int, sbyte>((a, b) => a <= b);
            Handle<int, short>((a, b) => a <= b);
            Handle<int, ushort>((a, b) => a <= b);
            Handle<int, int>((a, b) => a <= b);
            Handle<int, uint>((a, b) => a <= b);
            Handle<int, long>((a, b) => a <= b);
            //Handle<int, ulong>((a, b) => a <= b);
            Handle<int, float>((a, b) => a <= b);
            Handle<int, decimal>((a, b) => a <= b);
            Handle<int, double>((a, b) => a <= b);

            Handle<uint, byte>((a, b) => a <= b);
            Handle<uint, sbyte>((a, b) => a <= b);
            Handle<uint, short>((a, b) => a <= b);
            Handle<uint, ushort>((a, b) => a <= b);
            Handle<uint, int>((a, b) => a <= b);
            Handle<uint, uint>((a, b) => a <= b);
            Handle<uint, long>((a, b) => a <= b);
            Handle<uint, ulong>((a, b) => a <= b);
            Handle<uint, float>((a, b) => a <= b);
            Handle<uint, decimal>((a, b) => a <= b);
            Handle<uint, double>((a, b) => a <= b);

            Handle<long, byte>((a, b) => a <= b);
            Handle<long, sbyte>((a, b) => a <= b);
            Handle<long, short>((a, b) => a <= b);
            Handle<long, ushort>((a, b) => a <= b);
            Handle<long, int>((a, b) => a <= b);
            Handle<long, uint>((a, b) => a <= b);
            Handle<long, long>((a, b) => a <= b);
            //Handle<long, ulong>((a, b) => a <= b);
            Handle<long, float>((a, b) => a <= b);
            Handle<long, decimal>((a, b) => a <= b);
            Handle<long, double>((a, b) => a <= b);

            Handle<ulong, byte>((a, b) => a <= b);
            //Handle<ulong, sbyte>((a, b) => a <= b);
            //Handle<ulong, short>((a, b) => a <= b);
            Handle<ulong, ushort>((a, b) => a <= b);
            //Handle<ulong, int>((a, b) => a <= b);
            Handle<ulong, uint>((a, b) => a <= b);
            //Handle<ulong, long>((a, b) => a <= b);
            Handle<ulong, ulong>((a, b) => a <= b);
            Handle<ulong, float>((a, b) => a <= b);
            Handle<ulong, decimal>((a, b) => a <= b);
            Handle<ulong, double>((a, b) => a <= b);

            Handle<float, byte>((a, b) => a <= b);
            Handle<float, sbyte>((a, b) => a <= b);
            Handle<float, short>((a, b) => a <= b);
            Handle<float, ushort>((a, b) => a <= b);
            Handle<float, int>((a, b) => a <= b);
            Handle<float, uint>((a, b) => a <= b);
            Handle<float, long>((a, b) => a <= b);
            Handle<float, ulong>((a, b) => a <= b);
            Handle<float, float>((a, b) => a <= b || Mathf.Approximately(a, b));
            //Handle<float, decimal>((a, b) => a <= b);
            Handle<float, double>((a, b) => a <= b);

            Handle<decimal, byte>((a, b) => a <= b);
            Handle<decimal, sbyte>((a, b) => a <= b);
            Handle<decimal, short>((a, b) => a <= b);
            Handle<decimal, ushort>((a, b) => a <= b);
            Handle<decimal, int>((a, b) => a <= b);
            Handle<decimal, uint>((a, b) => a <= b);
            Handle<decimal, long>((a, b) => a <= b);
            Handle<decimal, ulong>((a, b) => a <= b);
            //Handle<decimal, float>((a, b) => a <= b);
            Handle<decimal, decimal>((a, b) => a <= b);
            //Handle<decimal, double>((a, b) => a <= b);

            Handle<double, byte>((a, b) => a <= b);
            Handle<double, sbyte>((a, b) => a <= b);
            Handle<double, short>((a, b) => a <= b);
            Handle<double, ushort>((a, b) => a <= b);
            Handle<double, int>((a, b) => a <= b);
            Handle<double, uint>((a, b) => a <= b);
            Handle<double, long>((a, b) => a <= b);
            Handle<double, ulong>((a, b) => a <= b);
            Handle<double, float>((a, b) => a <= b);
            //Handle<double, decimal>((a, b) => a <= b);
            Handle<double, double>((a, b) => a <= b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    namespace Unity.VisualScripting
{
    public sealed class ModuloHandler : BinaryOperatorHandler
    {
        public ModuloHandler() : base("Modulo", "Modulo", "%", "op_Modulus")
        {
            Handle<byte, byte>((a, b) => a % b);
            Handle<byte, sbyte>((a, b) => a % b);
            Handle<byte, short>((a, b) => a % b);
            Handle<byte, ushort>((a, b) => a % b);
            Handle<byte, int>((a, b) => a % b);
            Handle<byte, uint>((a, b) => a % b);
            Handle<byte, long>((a, b) => a % b);
            Handle<byte, ulong>((a, b) => a % b);
            Handle<byte, float>((a, b) => a % b);
            Handle<byte, decimal>((a, b) => a % b);
            Handle<byte, double>((a, b) => a % b);

            Handle<sbyte, byte>((a, b) => a % b);
            Handle<sbyte, sbyte>((a, b) => a % b);
            Handle<sbyte, short>((a, b) => a % b);
            Handle<sbyte, ushort>((a, b) => a % b);
            Handle<sbyte, int>((a, b) => a % b);
            Handle<sbyte, uint>((a, b) => a % b);
            Handle<sbyte, long>((a, b) => a % b);
            //Handle<sbyte, ulong>((a, b) => a % b);
            Handle<sbyte, float>((a, b) => a % b);
            Handle<sbyte, decimal>((a, b) => a % b);
            Handle<sbyte, double>((a, b) => a % b);

            Handle<short, byte>((a, b) => a % b);
            Handle<short, sbyte>((a, b) => a % b);
            Handle<short, short>((a, b) => a % b);
            Handle<short, ushort>((a, b) => a % b);
            Handle<short, int>((a, b) => a % b);
            Handle<short, uint>((a, b) => a % b);
            Handle<short, long>((a, b) => a % b);
            //Handle<short, ulong>((a, b) => a % b);
            Handle<short, float>((a, b) => a % b);
            Handle<short, decimal>((a, b) => a % b);
            Handle<short, double>((a, b) => a % b);

            Handle<ushort, byte>((a, b) => a % b);
            Handle<ushort, sbyte>((a, b) => a % b);
            Handle<ushort, short>((a, b) => a % b);
            Handle<ushort, ushort>((a, b) => a % b);
            Handle<ushort, int>((a, b) => a % b);
            Handle<ushort, uint>((a, b) => a % b);
            Handle<ushort, long>((a, b) => a % b);
            Handle<ushort, ulong>((a, b) => a % b);
            Handle<ushort, float>((a, b) => a % b);
            Handle<ushort, decimal>((a, b) => a % b);
            Handle<ushort, double>((a, b) => a % b);

            Handle<int, byte>((a, b) => a % b);
            Handle<int, sbyte>((a, b) => a % b);
            Handle<int, short>((a, b) => a % b);
            Handle<int, ushort>((a, b) => a % b);
            Handle<int, int>((a, b) => a % b);
            Handle<int, uint>((a, b) => a % b);
            Handle<int, long>((a, b) => a % b);
            //Handle<int, ulong>((a, b) => a % b);
            Handle<int, float>((a, b) => a % b);
            Handle<int, decimal>((a, b) => a % b);
            Handle<int, double>((a, b) => a % b);

            Handle<uint, byte>((a, b) => a % b);
            Handle<uint, sbyte>((a, b) => a % b);
            Handle<uint, short>((a, b) => a % b);
            Handle<uint, ushort>((a, b) => a % b);
            Handle<uint, int>((a, b) => a % b);
            Handle<uint, uint>((a, b) => a % b);
            Handle<uint, long>((a, b) => a % b);
            Handle<uint, ulong>((a, b) => a % b);
            Handle<uint, float>((a, b) => a % b);
            Handle<uint, decimal>((a, b) => a % b);
            Handle<uint, double>((a, b) => a % b);

            Handle<long, byte>((a, b) => a % b);
            Handle<long, sbyte>((a, b) => a % b);
            Handle<long, short>((a, b) => a % b);
            Handle<long, ushort>((a, b) => a % b);
            Handle<long, int>((a, b) => a % b);
            Handle<long, uint>((a, b) => a % b);
            Handle<long, long>((a, b) => a % b);
            //Handle<long, ulong>((a, b) => a % b);
            Handle<long, float>((a, b) => a % b);
            Handle<long, decimal>((a, b) => a % b);
            Handle<long, double>((a, b) => a % b);

            Handle<ulong, byte>((a, b) => a % b);
            //Handle<ulong, sbyte>((a, b) => a % b);
            //Handle<ulong, short>((a, b) => a % b);
            Handle<ulong, ushort>((a, b) => a % b);
            //Handle<ulong, int>((a, b) => a % b);
            Handle<ulong, uint>((a, b) => a % b);
            //Handle<ulong, long>((a, b) => a % b);
            Handle<ulong, ulong>((a, b) => a % b);
            Handle<ulong, float>((a, b) => a % b);
            Handle<ulong, decimal>((a, b) => a % b);
            Handle<ulong, double>((a, b) => a % b);

            Handle<float, byte>((a, b) => a % b);
            Handle<float, sbyte>((a, b) => a % b);
            Handle<float, short>((a, b) => a % b);
            Handle<float, ushort>((a, b) => a % b);
            Handle<float, int>((a, b) => a % b);
            Handle<float, uint>((a, b) => a % b);
            Handle<float, long>((a, b) => a % b);
            Handle<float, ulong>((a, b) => a % b);
            Handle<float, float>((a, b) => a % b);
            //Handle<float, decimal>((a, b) => a % b);
            Handle<float, double>((a, b) => a % b);

            Handle<decimal, byte>((a, b) => a % b);
            Handle<decimal, sbyte>((a, b) => a % b);
            Handle<decimal, short>((a, b) => a % b);
            Handle<decimal, ushort>((a, b) => a % b);
            Handle<decimal, int>((a, b) => a % b);
            Handle<decimal, uint>((a, b) => a % b);
            Handle<decimal, long>((a, b) => a % b);
            Handle<decimal, ulong>((a, b) => a % b);
            //Handle<decimal, float>((a, b) => a % b);
            Handle<decimal, decimal>((a, b) => a % b);
            //Handle<decimal, double>((a, b) => a % b);

            Handle<double, byte>((a, b) => a % b);
            Handle<double, sbyte>((a, b) => a % b);
            Handle<double, short>((a, b) => a % b);
            Handle<double, ushort>((a, b) => a % b);
            Handle<double, int>((a, b) => a % b);
            Handle<double, uint>((a, b) => a % b);
            Handle<double, long>((a, b) => a % b);
            Handle<double, ulong>((a, b) => a % b);
            Handle<double, float>((a, b) => a % b);
            //Handle<double, decimal>((a, b) => a % b);
            Handle<double, double>((a, b) => a % b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          namespace Unity.VisualScripting
{
    public sealed class MultiplicationHandler : BinaryOperatorHandler
    {
        public MultiplicationHandler() : base("Multiplication", "Multiply", "*", "op_Multiply")
        {
            Handle<byte, byte>((a, b) => a * b);
            Handle<byte, sbyte>((a, b) => a * b);
            Handle<byte, short>((a, b) => a * b);
            Handle<byte, ushort>((a, b) => a * b);
            Handle<byte, int>((a, b) => a * b);
            Handle<byte, uint>((a, b) => a * b);
            Handle<byte, long>((a, b) => a * b);
            Handle<byte, ulong>((a, b) => a * b);
            Handle<byte, float>((a, b) => a * b);
            Handle<byte, decimal>((a, b) => a * b);
            Handle<byte, double>((a, b) => a * b);

            Handle<sbyte, byte>((a, b) => a * b);
            Handle<sbyte, sbyte>((a, b) => a * b);
            Handle<sbyte, short>((a, b) => a * b);
            Handle<sbyte, ushort>((a, b) => a * b);
            Handle<sbyte, int>((a, b) => a * b);
            Handle<sbyte, uint>((a, b) => a * b);
            Handle<sbyte, long>((a, b) => a * b);
            //Handle<sbyte, ulong>((a, b) => a * b);
            Handle<sbyte, float>((a, b) => a * b);
            Handle<sbyte, decimal>((a, b) => a * b);
            Handle<sbyte, double>((a, b) => a * b);

            Handle<short, byte>((a, b) => a * b);
            Handle<short, sbyte>((a, b) => a * b);
            Handle<short, short>((a, b) => a * b);
            Handle<short, ushort>((a, b) => a * b);
            Handle<short, int>((a, b) => a * b);
            Handle<short, uint>((a, b) => a * b);
            Handle<short, long>((a, b) => a * b);
            //Handle<short, ulong>((a, b) => a * b);
            Handle<short, float>((a, b) => a * b);
            Handle<short, decimal>((a, b) => a * b);
            Handle<short, double>((a, b) => a * b);

            Handle<ushort, byte>((a, b) => a * b);
            Handle<ushort, sbyte>((a, b) => a * b);
            Handle<ushort, short>((a, b) => a * b);
            Handle<ushort, ushort>((a, b) => a * b);
            Handle<ushort, int>((a, b) => a * b);
            Handle<ushort, uint>((a, b) => a * b);
            Handle<ushort, long>((a, b) => a * b);
            Handle<ushort, ulong>((a, b) => a * b);
            Handle<ushort, float>((a, b) => a * b);
            Handle<ushort, decimal>((a, b) => a * b);
            Handle<ushort, double>((a, b) => a * b);

            Handle<int, byte>((a, b) => a * b);
            Handle<int, sbyte>((a, b) => a * b);
            Handle<int, short>((a, b) => a * b);
            Handle<int, ushort>((a, b) => a * b);
            Handle<int, int>((a, b) => a * b);
            Handle<int, uint>((a, b) => a * b);
            Handle<int, long>((a, b) => a * b);
            //Handle<int, ulong>((a, b) => a * b);
            Handle<int, float>((a, b) => a * b);
            Handle<int, decimal>((a, b) => a * b);
            Handle<int, double>((a, b) => a * b);

            Handle<uint, byte>((a, b) => a * b);
            Handle<uint, sbyte>((a, b) => a * b);
            Handle<uint, short>((a, b) => a * b);
            Handle<uint, ushort>((a, b) => a * b);
            Handle<uint, int>((a, b) => a * b);
            Handle<uint, uint>((a, b) => a * b);
            Handle<uint, long>((a, b) => a * b);
            Handle<uint, ulong>((a, b) => a * b);
            Handle<uint, float>((a, b) => a * b);
            Handle<uint, decimal>((a, b) => a * b);
            Handle<uint, double>((a, b) => a * b);

            Handle<long, byte>((a, b) => a * b);
            Handle<long, sbyte>((a, b) => a * b);
            Handle<long, short>((a, b) => a * b);
            Handle<long, ushort>((a, b) => a * b);
            Handle<long, int>((a, b) => a * b);
            Handle<long, uint>((a, b) => a * b);
            Handle<long, long>((a, b) => a * b);
            //Handle<long, ulong>((a, b) => a * b);
            Handle<long, float>((a, b) => a * b);
            Handle<long, decimal>((a, b) => a * b);
            Handle<long, double>((a, b) => a * b);

            Handle<ulong, byte>((a, b) => a * b);
            //Handle<ulong, sbyte>((a, b) => a * b);
            //Handle<ulong, short>((a, b) => a * b);
            Handle<ulong, ushort>((a, b) => a * b);
            //Handle<ulong, int>((a, b) => a * b);
            Handle<ulong, uint>((a, b) => a * b);
            //Handle<ulong, long>((a, b) => a * b);
            Handle<ulong, ulong>((a, b) => a * b);
            Handle<ulong, float>((a, b) => a * b);
            Handle<ulong, decimal>((a, b) => a * b);
            Handle<ulong, double>((a, b) => a * b);

            Handle<float, byte>((a, b) => a * b);
            Handle<float, sbyte>((a, b) => a * b);
            Handle<float, short>((a, b) => a * b);
            Handle<float, ushort>((a, b) => a * b);
            Handle<float, int>((a, b) => a * b);
            Handle<float, uint>((a, b) => a * b);
            Handle<float, long>((a, b) => a * b);
            Handle<float, ulong>((a, b) => a * b);
            Handle<float, float>((a, b) => a * b);
            //Handle<float, decimal>((a, b) => a * b);
            Handle<float, double>((a, b) => a * b);

            Handle<decimal, byte>((a, b) => a * b);
            Handle<decimal, sbyte>((a, b) => a * b);
            Handle<decimal, short>((a, b) => a * b);
            Handle<decimal, ushort>((a, b) => a * b);
            Handle<decimal, int>((a, b) => a * b);
            Handle<decimal, uint>((a, b) => a * b);
            Handle<decimal, long>((a, b) => a * b);
            Handle<decimal, ulong>((a, b) => a * b);
            //Handle<decimal, float>((a, b) => a * b);
            Handle<decimal, decimal>((a, b) => a * b);
            //Handle<decimal, double>((a, b) => a * b);

            Handle<double, byte>((a, b) => a * b);
            Handle<double, sbyte>((a, b) => a * b);
            Handle<double, short>((a, b) => a * b);
            Handle<double, ushort>((a, b) => a * b);
            Handle<double, int>((a, b) => a * b);
            Handle<double, uint>((a, b) => a * b);
            Handle<double, long>((a, b) => a * b);
            Handle<double, ulong>((a, b) => a * b);
            Handle<double, float>((a, b) => a * b);
            //Handle<double, decimal>((a, b) => a * b);
            Handle<double, double>((a, b) => a * b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               using System.Collections.Generic;

namespace Unity.VisualScripting
{
    public static class OperatorUtility
    {
        static OperatorUtility()
        {
            unaryOperatorHandlers.Add(UnaryOperator.LogicalNegation, logicalNegationHandler);
            unaryOperatorHandlers.Add(UnaryOperator.NumericNegation, numericNegationHandler);
            unaryOperatorHandlers.Add(UnaryOperator.Increment, incrementHandler);
            unaryOperatorHandlers.Add(UnaryOperator.Decrement, decrementHandler);
            unaryOperatorHandlers.Add(UnaryOperator.Plus, plusHandler);

            binaryOpeatorHandlers.Add(BinaryOperator.Addition, additionHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.Subtraction, subtractionHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.Multiplication, multiplicationHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.Division, divisionHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.Modulo, moduloHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.And, andHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.Or, orHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.ExclusiveOr, exclusiveOrHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.Equality, equalityHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.Inequality, inequalityHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.GreaterThan, greaterThanHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.LessThan, lessThanHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.GreaterThanOrEqual, greaterThanOrEqualHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.LessThanOrEqual, lessThanOrEqualHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.LeftShift, leftShiftHandler);
            binaryOpeatorHandlers.Add(BinaryOperator.RightShift, rightShiftHandler);
        }

        // https://msdn.microsoft.com/en-us/library/2sk3x8a7(v=vs.71).aspx
        public static readonly Dictionary<string, string> operatorNames = new Dictionary<string, string>
        {
            { "op_Addition", "+" },
            { "op_Subtraction", "-" },
            { "op_Multiply", "*" },
            { "op_Division", "/" },
            { "op_Modulus", "%" },
            { "op_ExclusiveOr", "^" },
            { "op_BitwiseAnd", "&" },
            { "op_BitwiseOr", "|" },
            { "op_LogicalAnd", "&&" },
            { "op_LogicalOr", "||" },
            { "op_Assign", "=" },
            { "op_LeftShift", "<<" },
            { "op_RightShift", ">>" },
            { "op_Equality", "==" },
            { "op_GreaterThan", ">" },
            { "op_LessThan", "<" },
            { "op_Inequality", "!=" },
            { "op_GreaterThanOrEqual", ">=" },
            { "op_LessThanOrEqual", "<=" },
            { "op_MultiplicationAssignment", "*=" },
            { "op_SubtractionAssignment", "-=" },
            { "op_ExclusiveOrAssignment", "^=" },
            { "op_LeftShiftAssignment", "<<=" },
            { "op_ModulusAssignment", "%=" },
            { "op_AdditionAssignment", "+=" },
            { "op_BitwiseAndAssignment", "&=" },
            { "op_BitwiseOrAssignment", "|=" },
            { "op_Comma", "," },
            { "op_DivisionAssignment", "/=" },
            { "op_Decrement", "--" },
            { "op_Increment", "++" },
            { "op_UnaryNegation", "-" },
            { "op_UnaryPlus", "+" },
            { "op_OnesComplement", "~" },
        };

        public static readonly Dictionary<string, int> operatorRanks = new Dictionary<string, int>
        {
            { "op_Addition", 2 },
            { "op_Subtraction", 2 },
            { "op_Multiply", 2 },
            { "op_Division", 2 },
            { "op_Modulus", 2 },
            { "op_ExclusiveOr", 2 },
            { "op_BitwiseAnd", 2 },
            { "op_BitwiseOr", 2 },
            { "op_LogicalAnd", 2 },
            { "op_LogicalOr", 2 },
            { "op_Assign", 2 },
            { "op_LeftShift", 2 },
            { "op_RightShift", 2 },
            { "op_Equality", 2 },
            { "op_GreaterThan", 2 },
            { "op_LessThan", 2 },
            { "op_Inequality", 2 },
            { "op_GreaterThanOrEqual", 2 },
            { "op_LessThanOrEqual", 2 },
            { "op_MultiplicationAssignment", 2 },
            { "op_SubtractionAssignment", 2 },
            { "op_ExclusiveOrAssignment", 2 },
            { "op_LeftShiftAssignment", 2 },
            { "op_ModulusAssignment", 2 },
            { "op_AdditionAssignment", 2 },
            { "op_BitwiseAndAssignment", 2 },
            { "op_BitwiseOrAssignment", 2 },
            { "op_Comma", 2 },
            { "op_DivisionAssignment", 2 },
            { "op_Decrement", 1 },
            { "op_Increment", 1 },
            { "op_UnaryNegation", 1 },
            { "op_UnaryPlus", 1 },
            { "op_OnesComplement", 1 },
        };

        private static readonly Dictionary<UnaryOperator, UnaryOperatorHandler> unaryOperatorHandlers = new Dictionary<UnaryOperator, UnaryOperatorHandler>();
        private static readonly Dictionary<BinaryOperator, BinaryOperatorHandler> binaryOpeatorHandlers = new Dictionary<BinaryOperator, BinaryOperatorHandler>();

        private static readonly LogicalNegationHandler logicalNegationHandler = new LogicalNegationHandler();
        private static readonly NumericNegationHandler numericNegationHandler = new NumericNegationHandler();
        private static readonly IncrementHandler incrementHandler = new IncrementHandler();
        private static readonly DecrementHandler decrementHandler = new DecrementHandler();
        private static readonly PlusHandler plusHandler = new PlusHandler();

        private static readonly AdditionHandler additionHandler = new AdditionHandler();
        private static readonly SubtractionHandler subtractionHandler = new SubtractionHandler();
        private static readonly MultiplicationHandler multiplicationHandler = new MultiplicationHandler();
        private static readonly DivisionHandler divisionHandler = new DivisionHandler();
        private static readonly ModuloHandler moduloHandler = new ModuloHandler();
        private static readonly AndHandler andHandler = new AndHandler();
        private static readonly OrHandler orHandler = new OrHandler();
        private static readonly ExclusiveOrHandler exclusiveOrHandler = new ExclusiveOrHandler();
        private static readonly EqualityHandler equalityHandler = new EqualityHandler();
        private static readonly InequalityHandler inequalityHandler = new InequalityHandler();
        private static readonly GreaterThanHandler greaterThanHandler = new GreaterThanHandler();
        private static readonly LessThanHandler lessThanHandler = new LessThanHandler();
        private static readonly GreaterThanOrEqualHandler greaterThanOrEqualHandler = new GreaterThanOrEqualHandler();
        private static readonly LessThanOrEqualHandler lessThanOrEqualHandler = new LessThanOrEqualHandler();
        private static readonly LeftShiftHandler leftShiftHandler = new LeftShiftHandler();
        private static readonly RightShiftHandler rightShiftHandler = new RightShiftHandler();

        public static UnaryOperatorHandler GetHandler(UnaryOperator @operator)
        {
            if (unaryOperatorHandlers.ContainsKey(@operator))
            {
                return unaryOperatorHandlers[@operator];
            }

            throw new UnexpectedEnumValueException<UnaryOperator>(@operator);
        }

        public static BinaryOperatorHandler GetHandler(BinaryOperator @operator)
        {
            if (binaryOpeatorHandlers.ContainsKey(@operator))
            {
                return binaryOpeatorHandlers[@operator];
            }

            throw new UnexpectedEnumValueException<BinaryOperator>(@operator);
        }

        public static string Symbol(this UnaryOperator @operator)
        {
            return GetHandler(@operator).symbol;
        }

        public static string Symbol(this BinaryOperator @operator)
        {
            return GetHandler(@operator).symbol;
        }

        public static string Name(this UnaryOperator @operator)
        {
            return GetHandler(@operator).name;
        }

        public static string Name(this BinaryOperator @operator)
        {
            return GetHandler(@operator).name;
        }

        public static string Verb(this UnaryOperator @operator)
        {
            return GetHandler(@operator).verb;
        }

        public static string Verb(this BinaryOperator @operator)
        {
            return GetHandler(@operator).verb;
        }

        public static object Operate(UnaryOperator @operator, object x)
        {
            if (!unaryOperatorHandlers.ContainsKey(@operator))
            {
                throw new UnexpectedEnumValueException<UnaryOperator>(@operator);
            }

            return unaryOperatorHandlers[@operator].Operate(x);
        }

        public static object Operate(BinaryOperator @operator, object a, object b)
        {
            if (!binaryOpeatorHandlers.ContainsKey(@operator))
            {
                throw new UnexpectedEnumValueException<BinaryOperator>(@operator);
            }

            return binaryOpeatorHandlers[@operator].Operate(a, b);
        }

        public static object Negate(object x)
        {
            return numericNegationHandler.Operate(x);
        }

        public static object Not(object x)
        {
            return logicalNegationHandler.Operate(x);
        }

        public static object UnaryPlus(object x)
        {
            return plusHandler.Operate(x);
        }

        public static object Increment(object x)
        {
            return incrementHandler.Operate(x);
        }

        public static object Decrement(object x)
        {
            return decrementHandler.Operate(x);
        }

        public static object And(object a, object b)
        {
            return andHandler.Operate(a, b);
        }

        public static object Or(object a, object b)
        {
            return orHandler.Operate(a, b);
        }

        public static object ExclusiveOr(object a, object b)
        {
            return exclusiveOrHandler.Operate(a, b);
        }

        public static object Add(object a, object b)
        {
            return additionHandler.Operate(a, b);
        }

        public static object Subtract(object a, object b)
        {
            return subtractionHandler.Operate(a, b);
        }

        public static object Multiply(object a, object b)
        {
            return multiplicationHandler.Operate(a, b);
        }

        public static object Divide(object a, object b)
        {
            return divisionHandler.Operate(a, b);
        }

        public static object Modulo(object a, object b)
        {
            return moduloHandler.Operate(a, b);
        }

        public static bool Equal(object a, object b)
        {
            return (bool)equalityHandler.Operate(a, b);
        }

        public static bool NotEqual(object a, object b)
        {
            return (bool)inequalityHandler.Operate(a, b);
        }

        public static bool GreaterThan(object a, object b)
        {
            return (bool)greaterThanHandler.Operate(a, b);
        }

        public static bool LessThan(object a, object b)
        {
            return (bool)lessThanHandler.Operate(a, b);
        }

        public static bool GreaterThanOrEqual(object a, object b)
        {
            return (bool)greaterThanOrEqualHandler.Operate(a, b);
        }

        public static bool LessThanOrEqual(object a, object b)
        {
            return (bool)lessThanOrEqualHandler.Operate(a, b);
        }

        public static object LeftShift(object a, object b)
        {
            return leftShiftHandler.Operate(a, b);
        }

        public static object RightShift(object a, object b)
        {
            return rightShiftHandler.Operate(a, b);
        }
    }
}
                                                                                                                                                                                    INDX( 	 ˚R          (     Ë       Ÿ d n            ¬ò    Ä p     ¢ò    ®°wY¿ÏŸ PõÓÇ§Ÿ óLÅ¿‰Ÿ¨»wY¿ÏŸ¯       Û                L e s s T h a n H a n d l e r . c s . m e t a √ò    à t     ¢ò    jxY¿ÏŸ PõÓÇ§Ÿb_KÅ¿‰Ÿm+xY¿ÏŸ        Ã               L e s s T h a n O r E q u a l H a n d l e r . c s     ƒò    ê ~     ¢ò    ~ÅxY¿ÏŸ PõÓÇ§Ÿ˛≤IÅ¿‰ŸtåxY¿ÏŸ¯       Û                L e s s T h a n O r E q u a l H a n d l e r . c s . m e t a   ë    à t     ¢ò    ˜£ÁÏŸ‡õ˚˙ùØ  ˜
ÁÏŸ2sÕ$ËÏŸ0      -               L o g i c a l N e g a t i o n H a n d l e r . c s . m ∆ò    ê ~     ¢ò    ¬'yY¿ÏŸ PõÓÇ§ŸëGÅ¿‰ŸOyY¿ÏŸ¯       Û                L o g i c a l N e g a t i o n H a n d l e r . c s . m e t a   «ò    x b     ¢ò    üyY¿ÏŸ PõÓÇ§ŸOÄFÅ¿‰ŸüyY¿ÏŸ        ˆ               M o d u l o H a n d l e r . c s       »ò    Ä l     ¢ò    ÌyY¿ÏŸ PõÓÇ§ŸÕΩDÅ¿‰Ÿ_zY¿ÏŸ¯       Û                M o d u l o H a n d l e r . c s . m e t a     …ò    à r     ¢ò    ∑dzY¿ÏŸ PõÓÇ§Ÿ≠CÅ¿‰Ÿ∑dzY¿ÏŸ                       M u l t i p l i c a t i o n H a n d l e r . c s        ò    ê |     ¢ò    ÌòzY¿ÏŸ PõÓÇ§Ÿ¯BÅ¿‰Ÿ*¿zY¿ÏŸ¯       Û                M u l t i p l i c a t i o n H a n d l e r . c s . m e t a     	ë    à t     ¢ò    ˜£ÁÏŸ‡õ˚˙ùØŸ˜P
ÁÏŸ LÕ$ËÏŸÄ      }               N u m e r i c N e g a t i o n H a n d l e r . c s . m Ãò    ê ~     ¢ò    ãn{Y¿ÏŸ PõÓÇ§Ÿõô?Å¿‰Ÿãn{Y¿ÏŸ¯       Û                N u m e r i c N e g a t i o n H a n  l e r . c s . m e t a   ë    Ä j     ¢ò    ˙y£ÁÏŸ0_¸˙ùØŸ˜P
ÁÏŸ%Õ$ËÏŸp      o               O p e r a t o r E x c e p t i o n . c s . m e Œò    à t     ¢ò    ∫|Y¿ÏŸ PõÓÇ§ŸXã=Å¿‰Ÿæ:|Y¿ÏŸ¯       Û                O p e r a t o r E x c e p t i o n . c s . m e t a     ë    x f     ¢ò    ˙y£ÁÏŸp˚¸˙ùØŸ˜P
ÁÏŸhÕ$ËÏŸ∞      Ø               O p e r a t o r H a n d l e r . c s . –ò    Ä p     ¢ò    /ı|Y¿ÏŸ PõÓÇ§ŸÁi;Å¿‰Ÿ/ı|Y¿ÏŸ¯       Û                O p e r a t o r H a  d l e r . c s . m e t a —ò    x f     ¢ò    +C}Y¿ÏŸ PõÓÇ§Ÿy1:Å¿‰Ÿj}Y¿ÏŸ 0      L/               O p e r a t o r U t i l i t y . c s   “ò    Ä p     ¢ò    ˝£}Y¿ÏŸ PõÓÇ§Ÿ»68Å¿‰Ÿ=À}Y¿ÏŸ¯       Û                O p e r a t o r U t i l i t y . c s . m e t a ë    p Z     ¢ò    ˘ˆ£ÁÏŸp˚¸˙ùØŸ˜P
ÁÏŸ2sÕ$ËÏŸ       †               O r H a n d l e r . c s . m e ‘ò    x d     ¢ò    zS~Y¿ÏŸ PõÓÇ§Ÿ6Å¿‰Ÿ4{~Y¿ÏŸ¯       Û                O r H a n d l e r . c s . m e t a     ë    p ^     ¢ò    Y§ÁÏŸ¿æ˝˙ùØŸ˜P
ÁÏŸ LÕ$ËÏŸX      S               P l u s H a n d l e r . c s . ÷ò    x h     ¢ò    ≈&Y¿ÏŸ PõÓÇ§Ÿø 4Å¿‰Ÿ≈&Y¿ÏŸ¯       Û                P l u s H a n d l e r . c s . m e t a ë    Ä j     ¢ò    √°£ÁÏŸ [˛˙ùØŸ˜P
ÁÏŸ%Õ$ËÏŸ       ·               R i g h t S h i f t H a n d l e r . c s . m e ÿò    à t     ¢ò    ÏY¿ÏŸ PõÓÇ§Ÿ’1Å¿‰ŸÏY¿ÏŸ¯       Û                R i g h t S h i f t H a n d l e r . c s . m e t a     Ÿò    Ä l     ¢ò    ?ÄY¿ÏŸ PõÓÇ§ŸNÎ0Å¿‰ŸfÄY¿ÏŸ                       S u b t r a c t i o n H a n d l e r . c s     ⁄ò    à v     ¢ò     ØÄY¿ÏŸ PõÓÇ§Ÿır/Å¿‰Ÿ ØÄY¿ÏŸ¯       Û                S u b t r a c t i o n H a n d l e r . c s . m e t a   ë    x b     ¢ò    ˘ˆ£ÁÏŸ [˛˙ùØŸ˜P
ÁÏŸhÕ$ËÏŸ∏       ≥                U n a r y O p e r a t o r . c s . m e ‹ò    Ä l     ¢ò    ‘qÅY¿ÏŸ PõÓÇ§ŸÅx-Å¿‰ŸòéÅY¿ÏŸ¯       Û                U n a r y O p e r a t o r . c s . m e t a     ë    Ä p     ¢ò    ±1§ÁÏŸ`Eˇ˙ùØŸ˜P
ÁÏŸ2sÕ$ËÏŸ       l	               U n a r y O p e r a t o r H a n d l e r . c s ﬁò    ê z     ¢ò    äÇY¿ÏŸ PõÓÇ§Ÿ4‚*Å¿‰Ÿ37ÇY¿ÏŸ¯       Û                U n a r y O p e r a t o r H a n d l e r . c s . m e t a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            namespace Unity.VisualScripting
{
    public sealed class SubtractionHandler : BinaryOperatorHandler
    {
        public SubtractionHandler() : base("Subtraction", "Subtract", "-", "op_Subtraction")
        {
            Handle<byte, byte>((a, b) => a - b);
            Handle<byte, sbyte>((a, b) => a - b);
            Handle<byte, short>((a, b) => a - b);
            Handle<byte, ushort>((a, b) => a - b);
            Handle<byte, int>((a, b) => a - b);
            Handle<byte, uint>((a, b) => a - b);
            Handle<byte, long>((a, b) => a - b);
            Handle<byte, ulong>((a, b) => a - b);
            Handle<byte, float>((a, b) => a - b);
            Handle<byte, decimal>((a, b) => a - b);
            Handle<byte, double>((a, b) => a - b);

            Handle<sbyte, byte>((a, b) => a - b);
            Handle<sbyte, sbyte>((a, b) => a - b);
            Handle<sbyte, short>((a, b) => a - b);
            Handle<sbyte, ushort>((a, b) => a - b);
            Handle<sbyte, int>((a, b) => a - b);
            Handle<sbyte, uint>((a, b) => a - b);
            Handle<sbyte, long>((a, b) => a - b);
            //Handle<sbyte, ulong>((a, b) => a - b);
            Handle<sbyte, float>((a, b) => a - b);
            Handle<sbyte, decimal>((a, b) => a - b);
            Handle<sbyte, double>((a, b) => a - b);

            Handle<short, byte>((a, b) => a - b);
            Handle<short, sbyte>((a, b) => a - b);
            Handle<short, short>((a, b) => a - b);
            Handle<short, ushort>((a, b) => a - b);
            Handle<short, int>((a, b) => a - b);
            Handle<short, uint>((a, b) => a - b);
            Handle<short, long>((a, b) => a - b);
            //Handle<short, ulong>((a, b) => a - b);
            Handle<short, float>((a, b) => a - b);
            Handle<short, decimal>((a, b) => a - b);
            Handle<short, double>((a, b) => a - b);

            Handle<ushort, byte>((a, b) => a - b);
            Handle<ushort, sbyte>((a, b) => a - b);
            Handle<ushort, short>((a, b) => a - b);
            Handle<ushort, ushort>((a, b) => a - b);
            Handle<ushort, int>((a, b) => a - b);
            Handle<ushort, uint>((a, b) => a - b);
            Handle<ushort, long>((a, b) => a - b);
            Handle<ushort, ulong>((a, b) => a - b);
            Handle<ushort, float>((a, b) => a - b);
            Handle<ushort, decimal>((a, b) => a - b);
            Handle<ushort, double>((a, b) => a - b);

            Handle<int, byte>((a, b) => a - b);
            Handle<int, sbyte>((a, b) => a - b);
            Handle<int, short>((a, b) => a - b);
            Handle<int, ushort>((a, b) => a - b);
            Handle<int, int>((a, b) => a - b);
            Handle<int, uint>((a, b) => a - b);
            Handle<int, long>((a, b) => a - b);
            //Handle<int, ulong>((a, b) => a - b);
            Handle<int, float>((a, b) => a - b);
            Handle<int, decimal>((a, b) => a - b);
            Handle<int, double>((a, b) => a - b);

            Handle<uint, byte>((a, b) => a - b);
            Handle<uint, sbyte>((a, b) => a - b);
            Handle<uint, short>((a, b) => a - b);
            Handle<uint, ushort>((a, b) => a - b);
            Handle<uint, int>((a, b) => a - b);
            Handle<uint, uint>((a, b) => a - b);
            Handle<uint, long>((a, b) => a - b);
            Handle<uint, ulong>((a, b) => a - b);
            Handle<uint, float>((a, b) => a - b);
            Handle<uint, decimal>((a, b) => a - b);
            Handle<uint, double>((a, b) => a - b);

            Handle<long, byte>((a, b) => a - b);
            Handle<long, sbyte>((a, b) => a - b);
            Handle<long, short>((a, b) => a - b);
            Handle<long, ushort>((a, b) => a - b);
            Handle<long, int>((a, b) => a - b);
            Handle<long, uint>((a, b) => a - b);
            Handle<long, long>((a, b) => a - b);
            //Handle<long, ulong>((a, b) => a - b);
            Handle<long, float>((a, b) => a - b);
            Handle<long, decimal>((a, b) => a - b);
            Handle<long, double>((a, b) => a - b);

            Handle<ulong, byte>((a, b) => a - b);
            //Handle<ulong, sbyte>((a, b) => a - b);
            //Handle<ulong, short>((a, b) => a - b);
            Handle<ulong, ushort>((a, b) => a - b);
            //Handle<ulong, int>((a, b) => a - b);
            Handle<ulong, uint>((a, b) => a - b);
            //Handle<ulong, long>((a, b) => a - b);
            Handle<ulong, ulong>((a, b) => a - b);
            Handle<ulong, float>((a, b) => a - b);
            Handle<ulong, decimal>((a, b) => a - b);
            Handle<ulong, double>((a, b) => a - b);

            Handle<float, byte>((a, b) => a - b);
            Handle<float, sbyte>((a, b) => a - b);
            Handle<float, short>((a, b) => a - b);
            Handle<float, ushort>((a, b) => a - b);
            Handle<float, int>((a, b) => a - b);
            Handle<float, uint>((a, b) => a - b);
            Handle<float, long>((a, b) => a - b);
            Handle<float, ulong>((a, b) => a - b);
            Handle<float, float>((a, b) => a - b);
            //Handle<float, decimal>((a, b) => a - b);
            Handle<float, double>((a, b) => a - b);

            Handle<decimal, byte>((a, b) => a - b);
            Handle<decimal, sbyte>((a, b) => a - b);
            Handle<decimal, short>((a, b) => a - b);
            Handle<decimal, ushort>((a, b) => a - b);
            Handle<decimal, int>((a, b) => a - b);
            Handle<decimal, uint>((a, b) => a - b);
            Handle<decimal, long>((a, b) => a - b);
            Handle<decimal, ulong>((a, b) => a - b);
            //Handle<decimal, float>((a, b) => a - b);
            Handle<decimal, decimal>((a, b) => a - b);
            //Handle<decimal, double>((a, b) => a - b);

            Handle<double, byte>((a, b) => a - b);
            Handle<double, sbyte>((a, b) => a - b);
            Handle<double, short>((a, b) => a - b);
            Handle<double, ushort>((a, b) => a - b);
            Handle<double, int>((a, b) => a - b);
            Handle<double, uint>((a, b) => a - b);
            Handle<double, long>((a, b) => a - b);
            Handle<double, ulong>((a, b) => a - b);
            Handle<double, float>((a, b) => a - b);
            //Handle<double, decimal>((a, b) => a - b);
            Handle<double, double>((a, b) => a - b);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     INDX( 	 «
T           (   à  Ë             I     s         ≤ì    h X     ﬂò    ¢ØÆÁÏŸ`Eˇ˙ùØŸ$
ÁÏŸ LÕ$ËÏŸà       Ü                A c t i o n _ 5 . c s ·ò    x b     ﬂò    &ÉY¿ÏŸ PõÓÇ§Ÿ ∞'Å¿‰ŸıMÉY¿ÏŸ¯       Û                A c t i o n _ 5 . c s . m e t a       ¬ì    h X     ﬂò    «NØÁÏŸ`Eˇ˙ùØŸ$
ÁÏŸ%Õ$ËÏŸò       ì                A c t i o n _ 6 . c s „ò    x b     ﬂò    r‚ÉY¿ÏŸ PõÓÇ§Ÿî‹%Å¿‰Ÿx	ÑY¿ÏŸ¯       Û                A c t i o n _ 6 . c s . m e t a      Àì    h T     ﬂò    Ã∞ØÁÏŸ`Eˇ˙ùØŸÃ_$
ÁÏŸhÕ$ËÏŸê       ê               	 F u n c _ 5 . c s . m Âò    p ^     ﬂò    æ∑ÑY¿ÏŸ PõÓÇ§ŸÇ‚#Å¿‰Ÿæ∑ÑY¿ÏŸ¯       Û                F u n c _ 5 . c s . m e t a   ∆ì    h T     ﬂò    «NØÁÏŸ†·ˇ˙ùØŸ$
ÁÏŸ2sÕ$ËÏŸ†       ù               	 F u n c _ 6 . c s . m Áò    p ^     ﬂò    úqÖY¿ÏŸ PõÓÇ§Ÿ°"Å¿‰Ÿ›õÖY¿ÏŸ¯       Û                F u n c _ 6 . c s . m e t a   6î    ê z     ﬂò    t'∞ÁÏŸ†·ˇ˙ùØŸÃ_$
ÁÏŸ%Õ$ËÏŸ                      I n s t a n c e A c t i o n I n v o k e r B a s e . c s . m e Èò    ò Ñ     ﬂò    Ê2ÜY¿ÏŸ PõÓÇ§Ÿœ±Å¿‰Ÿ]YÜY¿ÏŸ¯       Û               ! I n s t a n c e A c t i o n I n v o k e r B a s e . c s . m e t a     8î    à v     ﬂò    t'∞ÁÏŸ§ ˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ       _               I n s t a n c e A c t i o n I n v o k e r _ 0 . c s . Îò    ê Ä     ﬂò    vﬁÜY¿ÏŸ PõÓÇ§ŸìÅ¿‰Ÿ}áY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 0 . c s . m e t a <î    à v    ﬂò    Xƒ∞ÁÏŸ§ ˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ                      I n s t a n c e A c t i o n I n v o k e r _ 1 . c s . Ìò    ê Ä     ﬂò    ˇùáY¿ÏŸ PõÓÇ§Ÿ#>Å¿‰ŸˇùáY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 1 . c s . m e t a :î    à v     ﬂò    .b∞ÁÏŸ0A˚ùØŸÃ_$
ÁÏŸhÕ$ËÏŸ       À               I n s t a n c e A c t i o n I n v o k e r _ 2 . c s t               ﬂò    UjàY¿ÏŸ PõÓÇ§ŸœßÅ¿‰ŸUjàY¿ÏŸ¯       Û                I n s t a n c e A c t i o n  n v o k e r _ 2 . c s . m e t a ò    à v     ﬂò    eŸàY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸeŸàY¿ÏŸ       Ö	               I n s t a n c e A c t i o n I n v o k e r _ 3 . c s   Òò    ê Ä     ﬂò    O'âY¿ÏŸ PõÓÇ§ŸüˇÅ¿‰Ÿ›BâY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 3 . c s . m e t a Úò    à v     ﬂò    óúâY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ®âY¿ÏŸ       >
               I n s t a n c e A c t i o n I n v o k e r _ 4 . c s   Ûò    ê Ä     ﬂò    òÚâY¿ÏŸ PõÓÇ§ŸµTÅ¿‰ŸòÚâY¿ÏŸ¯      Û                I n s t a n c e A c t i o n I n v o k e r _ 4 . c s . m e t a Ùò    à v     ﬂò    g@äY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸlgäY¿ÏŸ       ˘
               I n s t a n c e A c t i o n I n v o k e r _ 5 . c s   ıò    ê Ä     ﬂò    0ÆäY¿ÏŸ PõÓÇ§ŸñÅ¿‰Ÿ0ÆäY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 5 . c s . m e t a ˆò    à r     ﬂò    ‡ãY¿ÏŸ PõÓÇ§Ÿ Ö
Å¿‰ŸÂ)ãY¿ÏŸ        K               I n s t a n c e F i e l d A c c e s s o r . c s       ˜ò    ê |    ﬂò    D|ãY¿ÏŸ PõÓÇ§Ÿ@ŸÅ¿‰ŸD|ãY¿ÏŸ¯       Û                I n s t a n c e F i e l d A c c e s s o r . c s . m e t a     ¯ò    ê ~     ﬂò    ?ªãY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸWÊãY¿ÏŸX      V               I n s t a n c e F u n c t i o n I n v o k e r B a s e . c s   ˘ò    ò à     ﬂò    ‘4åY¿ÏŸ PõÓÇ§Ÿ‰êÅ¿‰ŸØFåY¿ÏŸ¯       Û               # I n s t a n c e F u n c t i o n I n v o k e r B a s e . c s . m e t a ˙ò    ê z     ﬂò    ”zåY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸÿ°åY¿ÏŸ                      I n  t a n c e F u n c t i o n I n v o k e r _ 0 . c s       ˚ò    ò Ñ     ﬂò    f◊åY¿ÏŸ PõÓÇ§Ÿ≥”Å¿‰Ÿ‘˛åY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 0 . c s . m e t a     ¸ò    ê z     ﬂò    À5çY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ]çY¿ÏŸ       2               I n s t a n c e F u n c t i o n I n v o k e r _ 1 . c s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    using System;
using System.Linq.Expressions;
using System.Reflection;
using UnityEngine;

namespace Unity.VisualScripting
{
    public class InstanceFieldAccessor<TTarget, TField> : IOptimizedAccessor
    {
        public InstanceFieldAccessor(FieldInfo fieldInfo)
        {
            if (OptimizedReflection.safeMode)
            {
                Ensure.That(nameof(fieldInfo)).IsNotNull(fieldInfo);

                if (fieldInfo.DeclaringType != typeof(TTarget))
                {
                    throw new ArgumentException("Declaring type of field info doesn't match generic type.", nameof(fieldInfo));
                }

                if (fieldInfo.FieldType != typeof(TField))
                {
                    throw new ArgumentException("Field type of field info doesn't match generic type.", nameof(fieldInfo));
                }

                if (fieldInfo.IsStatic)
                {
                    throw new ArgumentException("The field is static.", nameof(fieldInfo));
                }
            }

            this.fieldInfo = fieldInfo;
        }

        private readonly FieldInfo fieldInfo;
        private Func<TTarget, TField> getter;
        private Action<TTarget, TField> setter;

        public void Compile()
        {
            if (OptimizedReflection.useJit)
            {
                var targetExpression = Expression.Parameter(typeof(TTarget), "target");

                // Getter

                var fieldExpression = Expression.Field(targetExpression, fieldInfo);
                getter = Expression.Lambda<Func<TTarget, TField>>(fieldExpression, targetExpression).Compile();

                // Setter

                if (fieldInfo.CanWrite())
                {
#if UNITY_2018_3_OR_NEWER
                    try
                    {
                        var valueExpression = Expression.Parameter(typeof(TField));
                        var assignExpression = Expression.Assign(fieldExpression, valueExpression);
                        setter = Expression.Lambda<Action<TTarget, TField>>(assignExpression, targetExpression, valueExpression).Compile();
                    }
                    catch
                    {
                        Debug.Log("Failed instance field: " + fieldInfo);
                        throw;
                    }
#else
                    var setterMethod = new DynamicMethod
                        (
                        "setter",
                        typeof(void),
                        new[] { typeof(TTarget), typeof(TField) },
                        typeof(TTarget),
                        true
                        );

                    var setterIL = setterMethod.GetILGenerator();

                    setterIL.Emit(OpCodes.Ldarg_0);
                    setterIL.Emit(OpCodes.Ldarg_1);
                    setterIL.Emit(OpCodes.Stfld, fieldInfo);
                    setterIL.Emit(OpCodes.Ret);

                    setter = (Action<TTarget, TField>)setterMethod.CreateDelegate(typeof(Action<TTarget, TField>));
#endif
                }
            }
            else
            {
                getter = (instance) => (TField)fieldInfo.GetValue(instance);

                if (fieldInfo.CanWrite())
                {
                    setter = (instance, value) => fieldInfo.SetValue(instance, value);
                }
            }
        }

        public object GetValue(object target)
        {
            if (OptimizedReflection.safeMode)
            {
                OptimizedReflection.VerifyInstanceTarget<TTarget>(target);

                try
                {
                    return GetValueUnsafe(target);
                }
                catch (TargetInvocationException)
                {
                    throw;
                }
                catch (Exception ex)
                {
                    throw new TargetInvocationException(ex);
                }
            }
            else
            {
                return GetValueUnsafe(target);
            }
        }

        private object GetValueUnsafe(object target)
        {
            // No need for special handling of value types, because field accessing cannot have side effects.
            // Therefore, working on a copy of the instance is faster and equivalent.

            return getter.Invoke((TTarget)target);
        }

        public void SetValue(object target, object value)
        {
            if (OptimizedReflection.safeMode)
            {
                OptimizedReflection.VerifyInstanceTarget<TTarget>(target);

                if (setter == null)
                {
                    throw new TargetException($"The field '{typeof(TTarget)}.{fieldInfo.Name}' cannot be assigned.");
                }

                if (!typeof(TField).IsAssignableFrom(value))
                {
                    throw new ArgumentException($"The provided value for '{typeof(TTarget)}.{fieldInfo.Name}' does not match the field type.\nProvided: {value?.GetType()?.ToString() ?? "null"}\nExpected: {typeof(TField)}");
                }

                try
                {
                    SetValueUnsafe(target, value);
                }
                catch (TargetInvocationException)
                {
                    throw;
                }
                catch (Exception ex)
                {
                    throw new TargetInvocationException(ex);
                }
            }
            else
            {
                SetValueUnsafe(target, value);
            }
        }

        private void SetValueUnsafe(object target, object value)
        {
            setter.Invoke((TTarget)target, (TField)value);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     INDX( 	 dT          (   x  Ë       Ÿs Ÿr Ÿo           @î    à v     ﬂò    Xƒ∞ÁÏŸ0A˚ùØŸÃ_$
ÁÏŸ2sÕ$ËÏŸ       Ö	               I n s t a n c e A c t i o n I n v o k e r _ 3 . c s . Òò    ê Ä     ﬂò    O'âY¿ÏŸ PõÓÇ§ŸüˇÅ¿‰Ÿ›BâY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 3 . c s . m e t a Bî    à v     ﬂò    Xƒ∞ÁÏŸ0A˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ       >
               I n s t a n c e A c t i o n I n v o k e r _ 4 . c s . Ûò    ê Ä     ﬂò    òÚâY¿Ï  PõÓÇ§ŸµTÅ¿‰ŸòÚâY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 4 . c s . m e t a Dî    à v     ﬂò    ND±ÁÏŸ0A˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ       ˘
               I n s t a n c e A c t i o n I n v o k e r _ 5 . c s . ıò    ê Ä     ﬂò    0ÆäY¿ÏŸ PõÓÇ§ŸñÅ¿‰Ÿ0ÆäY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 5 . c s . m e t a ˆò    à r     ﬂò    ‡ãY¿ÏŸ PõÓÇ§Ÿ Ö
Å¿‰ŸÂ)ãY¿ÏŸ        K               I n s t a n c e F i e l d A c c e s  o r . c s       ˜ò    ê |     ﬂò    D|ãY¿ÏŸ PõÓÇ§Ÿ@ŸÅ¿‰ŸD|ãY¿ÏŸ¯       Û                I n s t a n c e F i e l d A c c e s s o r . c s . m e t a     >î    ê ~     ﬂò    Xƒ∞ÁÏŸ†R˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸX      V               I n s t a n c e F u n c t i o n I n v o k e r B a s e . c s . ˘ò    ò à     ﬂò    ‘4åY¿ÏŸ PõÓÇ§Ÿ‰êÅ¿‰ŸØFåY¿ÏŸ¯       Û               # I n s t a n c e F u n c t i o n I n v o k e r B a s e . c s . m e t a Hî    ê z     ﬂò    [p±ÁÏŸ–«˚ùØŸÃ_$
ÁÏŸ“ÜÕ$ËÏ                       I n s t a n c e F u n c t i o n I n v o k e r _ 0 . c s . m e ˚ò    ò Ñ     ﬂò    f◊åY¿ÏŸ PõÓÇ§Ÿ≥”Å¿‰Ÿ‘˛åY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 0 . c s . m e t a     Fî    ê z     ﬂò    [p±ÁÏŸ†R˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ       2               I n s t a n c e F u n c t i o n I n v o k e r _ 1 . c s                     ﬂò    QãçY¿ÏŸ PõÓÇ§Ÿt» Å¿‰ŸR≤çY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e  _ 1 . c s . m e t a     ˛ò    ê z     ﬂò    Ó éY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ*éY¿ÏŸ       Ï               I n s t a n c e F u n c t i o n I n v o k e r _ 2 . c s       ˇò    ò Ñ     ﬂò    v]éY¿ÏŸ PõÓÇ§Ÿf˛Ä¿‰Ÿ|ÑéY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 2 . c s . m e t a      ô    ê z     ﬂò    æ èY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸæ èY¿ÏŸ       ¶	               I n s t a n c e F u n c t i o n I n v o k e r _ 3 . c s       ô    ò Ñ     ﬂò    ∆7êY¿ÏŸ PõÓÇ§Ÿ*a˚Ä¿‰ ∆7êY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 3 . c s . m e t a     ô    ê z     ﬂò    ≈ÖêY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸe´êY¿ÏŸ       `
               I n s t a n c e F u n c t i o n I n v o k e r _ 4 . c s       ô    ò Ñ     ﬂò    öÂêY¿ÏŸ PõÓÇ§Ÿ˙U¯Ä¿‰ŸëY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 4 . c s . m e t a     ô    ê z     ﬂò    #QëY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ+xëY¿ÏŸ                      I n s t a n c e F u n c t i  n I n v o k e r _ 5 . c s       ô    ò Ñ     ﬂò    `”ëY¿ÏŸ PõÓÇ§ŸıøıÄ¿‰Ÿ`”ëY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 5 . c s . m e t a     ô    Ä n     ﬂò    B!íY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸB!íY¿ÏŸ       Î               I n s t a n c e I n v o k e r B a s e . c s   ô    à x     ﬂò    ssíY¿ÏŸ PõÓÇ§ŸZPÛÄ¿‰ŸwöíY¿ÏŸ¯       Û                I n s t a n c e I n v o k e r B a s e . c s . m e t a ô    à x     ﬂò    ë÷íY¿ÏŸ PõÓÇ§Ÿ¥?ÚÄ¿‰Ÿò˝íY¿ÏŸ       ;               I n s t a n c e P r o p e r t y A c c e s s o r . c s 	ô    ò Ç     ﬂò    P1ìY¿ÏŸ PõÓÇ§ŸìÄ¿‰ŸRXìY¿ÏŸ¯       Û                 I n s t a n c e P r o p e r t y A c c e s s o r . c s . m e t a       
ô    p ^     ﬂò    =¶ìY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ=¶ìY¿ÏŸ       ä               I n v o k e r B a s e . c s   ô    x h     ﬂò    .ÙìY¿ÏŸ PõÓÇ§ŸãØÌÄ¿‰Ÿ.ÙìY¿ÏŸ¯       Û                I n v o k e r B a s e . c s . m e t a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      using System;
using System.Linq.Expressions;
using System.Reflection;

namespace Unity.VisualScripting
{
    public class InstancePropertyAccessor<TTarget, TProperty> : IOptimizedAccessor
    {
        public InstancePropertyAccessor(PropertyInfo propertyInfo)
        {
            if (OptimizedReflection.safeMode)
            {
                Ensure.That(nameof(propertyInfo)).IsNotNull(propertyInfo);

                if (propertyInfo.DeclaringType != typeof(TTarget))
                {
                    throw new ArgumentException("The declaring type of the property info doesn't match the generic type.", nameof(propertyInfo));
                }

                if (propertyInfo.PropertyType != typeof(TProperty))
                {
                    throw new ArgumentException("The property type of the property info doesn't match the generic type.", nameof(propertyInfo));
                }

                if (propertyInfo.IsStatic())
                {
                    throw new ArgumentException("The property is static.", nameof(propertyInfo));
                }
            }

            this.propertyInfo = propertyInfo;
        }

        private readonly PropertyInfo propertyInfo;
        private Func<TTarget, TProperty> getter;
        private Action<TTarget, TProperty> setter;

        public void Compile()
        {
            var getterInfo = propertyInfo.GetGetMethod(true);
            var setterInfo = propertyInfo.GetSetMethod(true);

            if (OptimizedReflection.useJit)
            {
                var targetExpression = Expression.Parameter(typeof(TTarget), "target");

                if (getterInfo != null)
                {
                    var propertyExpression = Expression.Property(targetExpression, propertyInfo);
                    getter = Expression.Lambda<Func<TTarget, TProperty>>(propertyExpression, targetExpression).Compile();
                }

                if (setterInfo != null)
                {
                    setter = (Action<TTarget, TProperty>)setterInfo.CreateDelegate(typeof(Action<TTarget, TProperty>));
                }
            }
            else
            {
                if (getterInfo != null)
                {
                    getter = (Func<TTarget, TProperty>)getterInfo.CreateDelegate(typeof(Func<TTarget, TProperty>));
                }

                if (setterInfo != null)
                {
                    setter = (Action<TTarget, TProperty>)setterInfo.CreateDelegate(typeof(Action<TTarget, TProperty>));
                }
            }
        }

        public object GetValue(object target)
        {
            if (OptimizedReflection.safeMode)
            {
                OptimizedReflection.VerifyInstanceTarget<TTarget>(target);

                if (getter == null)
                {
                    throw new TargetException($"The property '{typeof(TTarget)}.{propertyInfo.Name}' has no get accessor.");
                }

                try
                {
                    return GetValueUnsafe(target);
                }
                catch (TargetInvocationException)
                {
                    throw;
                }
                catch (Exception ex)
                {
                    throw new TargetInvocationException(ex);
                }
            }
            else
            {
                return GetValueUnsafe(target);
            }
        }

        private object GetValueUnsafe(object target)
        {
            return getter.Invoke((TTarget)target);
        }

        public void SetValue(object target, object value)
        {
            if (OptimizedReflection.safeMode)
            {
                OptimizedReflection.VerifyInstanceTarget<TTarget>(target);

                if (setter == null)
                {
                    throw new TargetException($"The property '{typeof(TTarget)}.{propertyInfo.Name}' has no set accessor.");
                }

                if (!typeof(TProperty).IsAssignableFrom(value))
                {
                    throw new ArgumentException($"The provided value for '{typeof(TTarget)}.{propertyInfo.Name}' does not match the property type.\nProvided: {value?.GetType()?.ToString() ?? "null"}\nExpected: {typeof(TProperty)}");
                }

                try
                {
                    SetValueUnsafe(target, value);
                }
                catch (TargetInvocationException)
                {
                    throw;
                }
                catch (Exception ex)
                {
                    throw new TargetInvocationException(ex);
                }
            }
            else
            {
                SetValueUnsafe(target, value);
            }
        }

        private void SetValueUnsafe(object target, object value)
        {
            setter.Invoke((TTarget)target, (TProperty)value);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     INDX( 	 Ö/T          (   p  Ë               d           Jî    ê z     ﬂò    [p±ÁÏŸ–«˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ       Ï               I n s t a n c e F u n c t i o n I n v o k e r _ 2 . c s . m e ˇò    ò Ñ     ﬂò    v]éY¿ÏŸ PõÓÇ§Ÿf˛Ä¿‰Ÿ|ÑéY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 2 . c s . m e t a     Lî    ê z     ﬂò    †ó±ÁÏŸ0≤˚ùØŸÃ_$
ÁÏŸ%Õ$ËÏŸ       ¶	               I n s t a n c e F u n c t i o n I n v o k e r _ 3 . c s . m e ô    ò Ñ     ﬂò    ∆7êY¿ÏŸ PõÓÇ§Ÿ*a˚Ä¿‰Ÿ∆7êY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 3 . c s . m e t a     Nî    ê z     ﬂò    Q“±ÁÏŸ`'˚ùØŸÃ_$
ÁÏŸ“ÜÕ$ËÏŸ       `
               I n s t a n c e F u n c t i o n I n v o k e r _ 4 . c s . m e ô    ò Ñ     ﬂò    öÂêY¿ÏŸ PõÓÇ§Ÿ˙U¯Ä¿‰ŸëY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 4 . c s . m e t a     Rî    ê z     ﬂò    Q“±ÁÏŸ`'˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ                     I n s t a n c e F u n c t i o n I n v o k e r _ 5 . c s . m e ô    ò Ñ     ﬂò    `”ëY¿ÏŸ PõÓÇ§ŸıøıÄ¿‰Ÿ`”ëY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 5 . c s . m e t a     Pî    Ä n     ﬂò    Q“±ÁÏŸ†√˚ùØŸÃ_$
ÁÏŸ%Õ$ËÏŸ       Î               I n s t a n c e I n v o k e r B a s e . c s . ô    à x     ﬂò    ssíY¿ÏŸ PõÓÇ§ŸZPÛÄ¿‰ŸwöíY¿ÏŸ¯       Û                I n s t a n c e I n v o k e r B a s e . c s . m e t a ô    à x     ﬂò    ë÷íY¿ÏŸ PõÓÇ§Ÿ¥?ÚÄ¿‰Ÿò˝íY¿ÏŸ        ;               I n s t a n c e P r o p e r t y A c c e s s o r . c s 	ô    ò Ç     ﬂò    P1ìY¿ÏŸ PõÓÇ§ŸìÄ¿‰ŸRXìY¿ÏŸ¯       Û                 I n s t a n c e P r o p e r t y A c c e s s o r . c s . m e t a       Tî    p ^     ﬂò    ± ≤ÁÏŸ‡_˚ùØŸÃ_$
ÁÏŸ“ÜÕ$ËÏŸ       ä               I n v o k e r B a s e . c s                 ﬂò    .ÙìY¿ÏŸ PõÓÇ§ŸãØÌÄ¿‰Ÿ.ÙìY¿ÏŸ¯       Û                I n v o k e r B a s e . c s . m e t a              ﬂò    iîY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸiîY¿ÏŸ–       Ã                I O p t i m i z e d A c c e s s o r . c s     ô    à v     ﬂò    ÌπîY¿ÏŸ PõÓÇ§ŸiÌÅ¿‰Ÿ¯‡îY¿ÏŸ¯       Û                I O p t i m i z e d A c c e s s o r . c s . m e t a   ô    Ä j     ﬂò    ».ïY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ».ïY¿ÏŸX      R               I O p t i m i z e d I n v o k e r . c s       ô    à t     ﬂò    .ÄïY¿ÏŸ PõÓÇ§ŸﬂÅ¿‰ŸØ®ïY¿ÏŸ¯       Û                I O p t i m i z e d I n v o k e r . c s . m e t a    ô    Ä n     ﬂò    Ω˜ïY¿ÏŸ PõÓÇ§Ÿ<wÏÄ¿‰ŸΩ˜ïY¿ÏŸ `      NR               O p t i m i z e d R e f l e c t i o n . c s   ô    à x     ﬂò    4QñY¿ÏŸ PõÓÇ§Ÿb}ÍÄ¿‰Ÿ4xñY¿ÏŸ¯       Û                O p t i m i z e d R e f l e c t i o n . c s . m e t a ô    à v     ﬂò    ∆ñY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸÌñY¿ÏŸ       Ÿ               R e f l e c t i o n F i e l d A c c e s s o r . c s   ô    ê Ä     ﬂò    ˛:óY¿ÏŸ PõÓÇ§Ÿı;ËÄ¿‰Ÿ˛:óY¿ÏŸ¯       Û                R e f l e c t i o n F i e l  A c c e s s o r . c s . m e t a ô    Ä j     ﬂò    „ØóY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ„ØóY¿ÏŸ       _               R e f l e c t i o n I n v o k e r . c s       ô    à t     ﬂò    kÁóY¿ÏŸ PõÓÇ§Ÿ˛@ÂÄ¿‰ŸÒòY¿ÏŸ¯       Û                R e f l e c t i o n I n v o k e r . c s . m e t a     ô    ê |     ﬂò    aòY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸaòY¿ÏŸ       	               R e f l e c t i o n P r o p e r t y A c c e s s o r . c s     ô    ò Ü     ﬂò    Ë§òY¿ÏŸ PõÓÇ§ŸJ™‚Ä¿‰ŸÌÀòY¿ÏŸ¯       Û              " R e f l e c t i o n P r o p e r t y A c c e s s o r . c s . m e t a   ô    à v     ﬂò    íôY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ≥-ôY¿ÏŸË       Ë                S t a t i c A c t i o n I n v o k e r B a s e . c s   ô    ê Ä     ﬂò    |{ôY¿ÏŸ PõÓÇ§ŸüØ‡Ä¿‰Ÿ|{ôY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r B a s e . c s . m e t a ô    à r     ﬂò    €ÁôY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ€ÁôY¿ÏŸ                      S t a t i c A c t i o n I n v o k e r _ 0 . c s                    using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using UnityEngine;

namespace Unity.VisualScripting
{
    // Inspirations:
    // http://stackoverflow.com/a/26733318
    // http://stackoverflow.com/a/16136854
    // http://stackoverflow.com/a/321686

    public static class OptimizedReflection
    {
        static OptimizedReflection()
        {
            fieldAccessors = new Dictionary<FieldInfo, IOptimizedAccessor>();
            propertyAccessors = new Dictionary<PropertyInfo, IOptimizedAccessor>();
            methodInvokers = new Dictionary<MethodInfo, IOptimizedInvoker>();

            jitAvailable = PlatformUtility.supportsJit;
        }

        private static readonly Dictionary<FieldInfo, IOptimizedAccessor> fieldAccessors;
        private static readonly Dictionary<PropertyInfo, IOptimizedAccessor> propertyAccessors;
        private static readonly Dictionary<MethodInfo, IOptimizedInvoker> methodInvokers;

        public static readonly bool jitAvailable;

        private static bool _useJitIfAvailable = true;

        internal static bool useJit => useJitIfAvailable && jitAvailable;

        public static bool useJitIfAvailable
        {
            get
            {
                return _useJitIfAvailable;
            }
            set
            {
                _useJitIfAvailable = value;
                ClearCache();
            }
        }

        public static bool safeMode { get; set; }

        internal static void OnRuntimeMethodLoad()
        {
            safeMode = Application.isEditor || Debug.isDebugBuild;
        }

        public static void ClearCache()
        {
            fieldAccessors.Clear();
            propertyAccessors.Clear();
            methodInvokers.Clear();
        }

        internal static void VerifyStaticTarget(Type targetType, object target)
        {
            VerifyTarget(targetType, target, true);
        }

        internal static void VerifyInstanceTarget<TTArget>(object target)
        {
            VerifyTarget(typeof(TTArget), target, false);
        }

        private static void VerifyTarget(Type targetType, object target, bool @static)
        {
            Ensure.That(nameof(targetType)).IsNotNull(targetType);

            if (@static)
            {
                if (target != null)
                {
                    throw new TargetException($"Superfluous target object for '{targetType}'.");
                }
            }
            else
            {
                if (target == null)
                {
                    throw new TargetException($"Missing target object for '{targetType}'.");
                }

                if (!targetType.IsAssignableFrom(targetType))
                {
                    throw new TargetException($"The target object does not match the target type.\nProvided: {target.GetType()}\nExpected: {targetType}");
                }
            }
        }

        private static bool SupportsOptimization(MemberInfo memberInfo)
        {
            // Instance members on value types require by-ref passing of the target object:
            // https://stackoverflow.com/a/1212396/154502

            // However, a bug in Unity's Mono version prevents by-ref delegates from working:
            // http://stackoverflow.com/questions/34743176/#comment73561434_34744241

            // Therefore, instance members on value types have to use reflection.

            if (memberInfo.DeclaringType.IsValueType && !memberInfo.IsStatic())
            {
                return false;
            }

            return true;
        }

        #region Fields

        public static IOptimizedAccessor Prewarm(this FieldInfo fieldInfo)
        {
            return GetFieldAccessor(fieldInfo);
        }

        public static object GetValueOptimized(this FieldInfo fieldInfo, object target)
        {
            return GetFieldAccessor(fieldInfo).GetValue(target);
        }

        public static void SetValueOptimized(this FieldInfo fieldInfo, object target, object value)
        {
            GetFieldAccessor(fieldInfo).SetValue(target, value);
        }

        public static bool SupportsOptimization(this FieldInfo fieldInfo)
        {
            if (!SupportsOptimization((MemberInfo)fieldInfo))
            {
                return false;
            }

            return true;
        }

        private static IOptimizedAccessor GetFieldAccessor(FieldInfo fieldInfo)
        {
            Ensure.That(nameof(fieldInfo)).IsNotNull(fieldInfo);

            lock (fieldAccessors)
            {
                if (!fieldAccessors.TryGetValue(fieldInfo, out var accessor))
                {
                    if (SupportsOptimization(fieldInfo))
                    {
                        Type accessorType;

                        if (fieldInfo.IsStatic)
                        {
                            accessorType = typeof(StaticFieldAccessor<>).MakeGenericType(fieldInfo.FieldType);
                        }
                        else
                        {
                            accessorType = typeof(InstanceFieldAccessor<,>).MakeGenericType(fieldInfo.DeclaringType, fieldInfo.FieldType);
                        }

                        accessor = (IOptimizedAccessor)Activator.CreateInstance(accessorType, fieldInfo);
                    }
                    else
                    {
                        accessor = new ReflectionFieldAccessor(fieldInfo);
                    }

                    accessor.Compile();

                    fieldAccessors.Add(fieldInfo, accessor);
                }

                return accessor;
            }
        }

        #endregion

        #region Properties

        public static IOptimizedAccessor Prewarm(this PropertyInfo propertyInfo)
        {
            return GetPropertyAccessor(propertyInfo);
        }

        public static object GetValueOptimized(this PropertyInfo propertyInfo, object target)
        {
            return GetPropertyAccessor(propertyInfo).GetValue(target);
        }

        public static void SetValueOptimized(this PropertyInfo propertyInfo, object target, object value)
        {
            GetPropertyAccessor(propertyInfo).SetValue(target, value);
        }

        public static bool SupportsOptimization(this PropertyInfo propertyInfo)
        {
            if (!SupportsOptimization((MemberInfo)propertyInfo))
            {
                return false;
            }

            return true;
        }

        private static IOptimizedAccessor GetPropertyAccessor(PropertyInfo propertyInfo)
        {
            Ensure.That(nameof(propertyInfo)).IsNotNull(propertyInfo);

            lock (propertyAccessors)
            {
                if (!propertyAccessors.TryGetValue(propertyInfo, out var accessor))
                {
                    if (SupportsOptimization(propertyInfo))
                    {
                        Type accessorType;

                        if (propertyInfo.IsStatic())
                        {
                            accessorType = typeof(StaticPropertyAccessor<>).MakeGenericType(propertyInfo.PropertyType);
                        }
                        else
                        {
                            accessorType = typeof(InstancePropertyAccessor<,>).MakeGenericType(propertyInfo.DeclaringType, propertyInfo.PropertyType);
                        }

                        accessor = (IOptimizedAccessor)Activator.CreateInstance(accessorType, propertyInfo);
                    }
                    else
                    {
                        accessor = new ReflectionPropertyAccessor(propertyInfo);
                    }

                    accessor.Compile();

                    propertyAccessors.Add(propertyInfo, accessor);
                }

                return accessor;
            }
        }

        #endregion

        #region Methods

        public static IOptimizedInvoker Prewarm(this MethodInfo methodInfo)
        {
            return GetMethodInvoker(methodInfo);
        }

        public static object InvokeOptimized(this MethodInfo methodInfo, object target, params object[] args)
        {
            return GetMethodInvoker(methodInfo).Invoke(target, args);
        }

        public static object InvokeOptimized(this MethodInfo methodInfo, object target)
        {
            return GetMethodInvoker(methodInfo).Invoke(target);
        }

        public static object InvokeOptimized(this MethodInfo methodInfo, object target, object arg0)
        {
            return GetMethodInvoker(methodInfo).Invoke(target, arg0);
        }

        public static object InvokeOptimized(this MethodInfo methodInfo, object target, object arg0, object arg1)
        {
            return GetMethodInvoker(methodInfo).Invoke(target, arg0, arg1);
        }

        public static object InvokeOptimized(this MethodInfo methodInfo, object target, object arg0, object arg1, object arg2)
        {
            return GetMethodInvoker(methodInfo).Invoke(target, arg0, arg1, arg2);
        }

        public static object InvokeOptimized(this MethodInfo methodInfo, object target, object arg0, object arg1, object arg2, object arg3)
        {
            return GetMethodInvoker(methodInfo).Invoke(target, arg0, arg1, arg2, arg3);
        }

        public static object InvokeOptimized(this MethodInfo methodInfo, object target, object arg0, object arg1, object arg2, object arg3, object arg4)
        {
            return GetMethodInvoker(methodInfo).Invoke(target, arg0, arg1, arg2, arg3, arg4);
        }

        public static bool SupportsOptimization(this MethodInfo methodInfo)
        {
            if (!SupportsOptimization((MemberInfo)methodInfo))
            {
                return false;
            }

            var parameters = methodInfo.GetParameters();

            if (parameters.Length > 5)
            {
                return false;
            }

            if (parameters.Any(parameter => parameter.ParameterType.IsByRef))
            {
                return false;
            }

            // CreateDelegate in IL2CPP does not work properly for overridden methods, instead referring to the virtual method.
            // https://support.ludiq.io/forums/5-bolt/topics/872-virtual-method-overrides-not-used-on-aot/
            // https://fogbugz.unity3d.com/default.asp?980136_228np3be9idtbdtt
            if (!jitAvailable && methodInfo.IsVirtual && !methodInfo.IsFinal)
            {
                return false;
            }

            // Undocumented __arglist keyword as used in the 4+ overload of String.Concat causes runtime crash
            if (methodInfo.CallingConvention == CallingConventions.VarArgs)
            {
                return false;
            }

            return true;
        }

        private static IOptimizedInvoker GetMethodInvoker(MethodInfo methodInfo)
        {
            Ensure.That(nameof(methodInfo)).IsNotNull(methodInfo);

            lock (methodInvokers)
            {
                if (!methodInvokers.TryGetValue(methodInfo, out var invoker))
                {
                    if (SupportsOptimization(methodInfo))
                    {
                        Type invokerType;

                        var parameters = methodInfo.GetParameters();

                        if (methodInfo.ReturnType == typeof(void))
                        {
                            if (methodInfo.IsStatic)
                            {
                                if (parameters.Length == 0)
                                {
                                    invokerType = typeof(StaticActionInvoker);
                                }
                                else if (parameters.Length == 1)
                                {
                                    invokerType = typeof(StaticActionInvoker<>).MakeGenericType(parameters[0].ParameterType);
                                }
                                else if (parameters.Length == 2)
                                {
                                    invokerType = typeof(StaticActionInvoker<,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType);
                                }
                                else if (parameters.Length == 3)
                                {
                                    invokerType = typeof(StaticActionInvoker<,,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType);
                                }
                                else if (parameters.Length == 4)
                                {
                                    invokerType = typeof(StaticActionInvoker<,,,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType);
                                }
                                else if (parameters.Length == 5)
                                {
                                    invokerType = typeof(StaticActionInvoker<,,,,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType, parameters[4].ParameterType);
                                }
                                else
                                {
                                    throw new NotSupportedException();
                                }
                            }
                            else
                            {
                                if (parameters.Length == 0)
                                {
                                    invokerType = typeof(InstanceActionInvoker<>).MakeGenericType(methodInfo.DeclaringType);
                                }
                                else if (parameters.Length == 1)
                                {
                                    invokerType = typeof(InstanceActionInvoker<,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType);
                                }
                                else if (parameters.Length == 2)
                                {
                                    invokerType = typeof(InstanceActionInvoker<,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType);
                                }
                                else if (parameters.Length == 3)
                                {
                                    invokerType = typeof(InstanceActionInvoker<,,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType);
                                }
                                else if (parameters.Length == 4)
                                {
                                    invokerType = typeof(InstanceActionInvoker<,,,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType);
                                }
                                else if (parameters.Length == 5)
                                {
                                    invokerType = typeof(InstanceActionInvoker<,,,,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType, parameters[4].ParameterType);
                                }
                                else
                                {
                                    throw new NotSupportedException();
                                }
                            }
                        }
                        else
                        {
                            if (methodInfo.IsStatic)
                            {
                                if (parameters.Length == 0)
                                {
                                    invokerType = typeof(StaticFunctionInvoker<>).MakeGenericType(methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 1)
                                {
                                    invokerType = typeof(StaticFunctionInvoker<,>).MakeGenericType(parameters[0].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 2)
                                {
                                    invokerType = typeof(StaticFunctionInvoker<,,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 3)
                                {
                                    invokerType = typeof(StaticFunctionInvoker<,,,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 4)
                                {
                                    invokerType = typeof(StaticFunctionInvoker<,,,,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 5)
                                {
                                    invokerType = typeof(StaticFunctionInvoker<,,,,,>).MakeGenericType(parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType, parameters[4].ParameterType, methodInfo.ReturnType);
                                }
                                else
                                {
                                    throw new NotSupportedException();
                                }
                            }
                            else
                            {
                                if (parameters.Length == 0)
                                {
                                    invokerType = typeof(InstanceFunctionInvoker<,>).MakeGenericType(methodInfo.DeclaringType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 1)
                                {
                                    invokerType = typeof(InstanceFunctionInvoker<,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 2)
                                {
                                    invokerType = typeof(InstanceFunctionInvoker<,,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 3)
                                {
                                    invokerType = typeof(InstanceFunctionInvoker<,,,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 4)
                                {
                                    invokerType = typeof(InstanceFunctionInvoker<,,,,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType, methodInfo.ReturnType);
                                }
                                else if (parameters.Length == 5)
                                {
                                    invokerType = typeof(InstanceFunctionInvoker<,,,,,,>).MakeGenericType(methodInfo.DeclaringType, parameters[0].ParameterType, parameters[1].ParameterType, parameters[2].ParameterType, parameters[3].ParameterType, parameters[4].ParameterType, methodInfo.ReturnType);
                                }
                                else
                                {
                                    throw new NotSupportedException();
                                }
                            }
                        }

                        invoker = (IOptimizedInvoker)Activator.CreateInstance(invokerType, methodInfo);
                    }
                    else
                    {
                        invoker = new ReflectionInvoker(methodInfo);
                    }

                    invoker.Compile();

                    methodInvokers.Add(methodInfo, invoker);
                }

                return invoker;
            }
        }

        #endregion
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  , "tid": 12884901888, "ts": 1695341688103422, "dur": 16, "ph": "X", "name": "ReadAsync 190", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103440, "dur": 35, "ph": "X", "name": "ReadAsync 286", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103478, "dur": 17, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103499, "dur": 25, "ph": "X", "name": "ReadAsync 303", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103526, "dur": 1, "ph": "X", "name": "ProcessMessages 283", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103528, "dur": 22, "ph": "X", "name": "ReadAsync 283", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103552, "dur": 1, "ph": "X", "name": "ProcessMessages 292", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103554, "dur": 25, "ph": "X", "name": "ReadAsync 292", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103581, "dur": 26, "ph": "X", "name": "ReadAsync 181", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103610, "dur": 1, "ph": "X", "name": "ProcessMessages 395", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103612, "dur": 21, "ph": "X", "name": "ReadAsync 395", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103636, "dur": 1, "ph": "X", "name": "ProcessMessages 169", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103638, "dur": 23, "ph": "X", "name": "ReadAsync 169", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103664, "dur": 133, "ph": "X", "name": "ReadAsync 262", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103800, "dur": 25, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103827, "dur": 17, "ph": "X", "name": "ReadAsync 347", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103847, "dur": 19, "ph": "X", "name": "ReadAsync 239", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103869, "dur": 18, "ph": "X", "name": "ReadAsync 394", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103890, "dur": 22, "ph": "X", "name": "ReadAsync 130", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103915, "dur": 20, "ph": "X", "name": "ReadAsync 338", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103938, "dur": 17, "ph": "X", "name": "ReadAsync 187", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103958, "dur": 29, "ph": "X", "name": "ReadAsync 250", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688103991, "dur": 17, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104011, "dur": 17, "ph": "X", "name": "ReadAsync 330", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104031, "dur": 19, "ph": "X", "name": "ReadAsync 319", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104053, "dur": 46, "ph": "X", "name": "ReadAsync 319", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104101, "dur": 17, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104123, "dur": 18, "ph": "X", "name": "ReadAsync 247", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104145, "dur": 16, "ph": "X", "name": "ReadAsync 262", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104164, "dur": 17, "ph": "X", "name": "ReadAsync 305", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104183, "dur": 43, "ph": "X", "name": "ReadAsync 289", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104228, "dur": 19, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104250, "dur": 1, "ph": "X", "name": "ProcessMessages 324", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104252, "dur": 26, "ph": "X", "name": "ReadAsync 324", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104280, "dur": 1, "ph": "X", "name": "ProcessMessages 435", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104282, "dur": 26, "ph": "X", "name": "ReadAsync 435", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104311, "dur": 1, "ph": "X", "name": "ProcessMessages 378", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104314, "dur": 29, "ph": "X", "name": "ReadAsync 378", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104345, "dur": 1, "ph": "X", "name": "ProcessMessages 543", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104346, "dur": 17, "ph": "X", "name": "ReadAsync 543", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104366, "dur": 21, "ph": "X", "name": "ReadAsync 120", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104389, "dur": 22, "ph": "X", "name": "ReadAsync 239", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104416, "dur": 32, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104450, "dur": 1, "ph": "X", "name": "ProcessMessages 845", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104452, "dur": 19, "ph": "X", "name": "ReadAsync 845", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104474, "dur": 19, "ph": "X", "name": "ReadAsync 403", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104497, "dur": 27, "ph": "X", "name": "ReadAsync 44", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104528, "dur": 24, "ph": "X", "name": "ReadAsync 550", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104555, "dur": 16, "ph": "X", "name": "ReadAsync 373", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104574, "dur": 18, "ph": "X", "name": "ReadAsync 255", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104594, "dur": 27, "ph": "X", "name": "ReadAsync 229", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104626, "dur": 34, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104662, "dur": 1, "ph": "X", "name": "ProcessMessages 915", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104665, "dur": 35, "ph": "X", "name": "ReadAsync 915", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104703, "dur": 1, "ph": "X", "name": "ProcessMessages 961", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104705, "dur": 26, "ph": "X", "name": "ReadAsync 961", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104733, "dur": 1, "ph": "X", "name": "ProcessMessages 640", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104736, "dur": 24, "ph": "X", "name": "ReadAsync 640", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104762, "dur": 20, "ph": "X", "name": "ReadAsync 403", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104785, "dur": 15, "ph": "X", "name": "ReadAsync 242", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104802, "dur": 22, "ph": "X", "name": "ReadAsync 82", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104829, "dur": 27, "ph": "X", "name": "ReadAsync 249", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104858, "dur": 1, "ph": "X", "name": "ProcessMessages 347", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104861, "dur": 27, "ph": "X", "name": "ReadAsync 347", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104890, "dur": 1, "ph": "X", "name": "ProcessMessages 485", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104892, "dur": 23, "ph": "X", "name": "ReadAsync 485", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104918, "dur": 1, "ph": "X", "name": "ProcessMessages 287", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104920, "dur": 19, "ph": "X", "name": "ReadAsync 287", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104942, "dur": 16, "ph": "X", "name": "ReadAsync 271", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104961, "dur": 18, "ph": "X", "name": "ReadAsync 315", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688104982, "dur": 27, "ph": "X", "name": "ReadAsync 295", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105012, "dur": 21, "ph": "X", "name": "ReadAsync 272", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105035, "dur": 1, "ph": "X", "name": "ProcessMessages 240", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105037, "dur": 26, "ph": "X", "name": "ReadAsync 240", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105067, "dur": 17, "ph": "X", "name": "ReadAsync 433", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105088, "dur": 24, "ph": "X", "name": "ReadAsync 188", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105115, "dur": 1, "ph": "X", "name": "ProcessMessages 154", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105118, "dur": 25, "ph": "X", "name": "ReadAsync 154", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105145, "dur": 1, "ph": "X", "name": "ProcessMessages 470", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105147, "dur": 27, "ph": "X", "name": "ReadAsync 470", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105177, "dur": 1, "ph": "X", "name": "ProcessMessages 212", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105179, "dur": 27, "ph": "X", "name": "ReadAsync 212", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105210, "dur": 27, "ph": "X", "name": "ReadAsync 245", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105239, "dur": 1, "ph": "X", "name": "ProcessMessages 292", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105240, "dur": 18, "ph": "X", "name": "ReadAsync 292", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105262, "dur": 25, "ph": "X", "name": "ReadAsync 256", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105289, "dur": 1, "ph": "X", "name": "ProcessMessages 302", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105290, "dur": 20, "ph": "X", "name": "ReadAsync 302", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105313, "dur": 18, "ph": "X", "name": "ReadAsync 205", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105333, "dur": 37, "ph": "X", "name": "ReadAsync 179", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105375, "dur": 22, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105401, "dur": 16, "ph": "X", "name": "ReadAsync 404", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105420, "dur": 16, "ph": "X", "name": "ReadAsync 315", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105437, "dur": 1, "ph": "X", "name": "ProcessMessages 329", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105439, "dur": 25, "ph": "X", "name": "ReadAsync 329", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105466, "dur": 19, "ph": "X", "name": "ReadAsync 288", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105488, "dur": 21, "ph": "X", "name": "ReadAsync 313", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105511, "dur": 24, "ph": "X", "name": "ReadAsync 335", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105538, "dur": 15, "ph": "X", "name": "ReadAsync 319", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105555, "dur": 25, "ph": "X", "name": "ReadAsync 44", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105583, "dur": 1, "ph": "X", "name": "ProcessMessages 307", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105586, "dur": 26, "ph": "X", "name": "ReadAsync 307", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105615, "dur": 30, "ph": "X", "name": "ReadAsync 331", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105648, "dur": 23, "ph": "X", "name": "ReadAsync 596", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105672, "dur": 1, "ph": "X", "name": "ProcessMessages 504", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105674, "dur": 21, "ph": "X", "name": "ReadAsync 504", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105698, "dur": 26, "ph": "X", "name": "ReadAsync 379", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105728, "dur": 26, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105756, "dur": 1, "ph": "X", "name": "ProcessMessages 482", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105757, "dur": 18, "ph": "X", "name": "ReadAsync 482", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105777, "dur": 20, "ph": "X", "name": "ReadAsync 237", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105799, "dur": 1, "ph": "X", "name": "ProcessMessages 349", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105800, "dur": 23, "ph": "X", "name": "ReadAsync 349", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105826, "dur": 18, "ph": "X", "name": "ReadAsync 301", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105846, "dur": 22, "ph": "X", "name": "ReadAsync 280", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105870, "dur": 1, "ph": "X", "name": "ProcessMessages 347", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105872, "dur": 19, "ph": "X", "name": "ReadAsync 347", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688105893, "dur": 268, "ph": "X", "name": "ReadAsync 307", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106164, "dur": 25, "ph": "X", "name": "ReadAsync 12", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106192, "dur": 1, "ph": "X", "name": "ProcessMessages 342", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106195, "dur": 31, "ph": "X", "name": "ReadAsync 342", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106229, "dur": 1, "ph": "X", "name": "ProcessMessages 576", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106230, "dur": 28, "ph": "X", "name": "ReadAsync 576", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106260, "dur": 1, "ph": "X", "name": "ProcessMessages 405", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106262, "dur": 22, "ph": "X", "name": "ReadAsync 405", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106287, "dur": 20, "ph": "X", "name": "ReadAsync 469", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106309, "dur": 14, "ph": "X", "name": "ReadAsync 309", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106326, "dur": 21, "ph": "X", "name": "ReadAsync 70", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106350, "dur": 1, "ph": "X", "name": "ProcessMessages 375", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106352, "dur": 22, "ph": "X", "name": "ReadAsync 375", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106377, "dur": 19, "ph": "X", "name": "ReadAsync 623", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106399, "dur": 22, "ph": "X", "name": "ReadAsync 376", "args": {} },
{ "pid": 12052, "tid": 12884901888, "ts": 1695341688106423, "dur": 1, "ph": "X", "name": "ProcessMessages 426", "args": {} },
{ "pid": 12052, "tid": 1INDX( 	 ¶>T          (   8  Ë       ŸŸ.     o Ÿ        »ì    Ä l     ﬂò    vØÁÏŸÜ˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ–       Ã                I O p t i m i z e d A c c e s s o r . c s . m ô    à v     ﬂò    ÌπîY¿ÏŸ PõÓÇ§ŸiÌÅ¿‰Ÿ¯‡îY¿ÏŸ¯       Û                I O p t i m i z e d A c c e s s o r . c s . m e t a   4î    Ä j     ﬂò    ŸØÁÏŸÜ˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸX      R               I O p t i m i z e d I n v o k e r . c s . m e ô    à t     ﬂò    .ÄïY¿ÏŸ PõÓÇ§ŸﬂÅ¿‰ŸØ®ïY¿Ï ¯       Û                I O p t i m i z e d I n v o k e r . c s . m e t a     ô    Ä n     ﬂò    Ω˜ïY¿ÏŸ PõÓÇ§Ÿ<wÏÄ¿‰ŸΩ˜ïY¿ÏŸ `      NR               O p t i m i z e d R e f l e c t i o n . c s   ô    à x     ﬂò    4QñY¿ÏŸ PõÓÇ§Ÿb}ÍÄ¿‰Ÿ4xñY¿ÏŸ¯       Û                O p t i m i z e d R e f l e c t i o n . c s . m e t a Yî    à v     ﬂò    K4≤ÁÏŸ`ò˚ùØŸÃ_$
ÁÏŸ%Õ$ËÏŸ       Ÿ               R e f l e c t i o n F i e l d A c c e s s o r . c s . ô    ê Ä     ﬂò    ˛:óY¿Ï  PõÓÇ§Ÿı;ËÄ¿‰Ÿ˛:óY¿ÏŸ¯       Û                R e f l e c t i o n F i e l d A c c e s s o r . c s . m e t a _î    Ä j     ﬂò    ∂Ω≤ÁÏŸ`ò˚ùØŸÃ_$
ÁÏŸ“ÜÕ$ËÏŸ       _               R e f l e c t i o n I n v o k e r . c s . m e ô    à t     ﬂò    kÁóY¿ÏŸ PõÓÇ§Ÿ˛@ÂÄ¿‰ŸÒòY¿ÏŸ¯       Û                R e f l e c t i o n I n v o k e r . c s . m e t a     ]î    ê |     ﬂò    `[≤ÁÏŸ`ò˚ùØŸÃ_$
ÁÏŸ2sÕ$ËÏŸ       	               R e f l e c t i o n P r o p e r t y A c c e s s o r  c s . m ô    ò Ü     ﬂò    Ë§òY¿ÏŸ PõÓÇ§ŸJ™‚Ä¿‰ŸÌÀòY¿ÏŸ¯       Û               " R e f l e c t i o n P r o p e r t y A c c e s s o r . c s . m e t a   Vî    à v     ﬂò    K4≤ÁÏŸ–©˚ùØŸÃ_$
ÁÏŸ“ÜÕ$ËÏŸË       Ë                S t a t i c A c t i o n I n v o k e r B a s e . c s . ô    ê Ä     ﬂò    |{ôY¿ÏŸ PõÓÇ§ŸüØ‡Ä¿‰Ÿ|{ôY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r B a s e . c s . m e t a [î    à r     ﬂò    K4≤ÁÏŸ–©˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ                     S t a t i c A c t i o n I n v o k e r _ 0 . c s k e r               ô    à r     ﬂò    £öY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸn öY¿ÏŸ       €               S t a t i c A c t i o n I n v o k e r _ 1 . c s       ô    ê |     ﬂò    n˛öY¿ÏŸ PõÓÇ§ŸŒ	€Ä¿‰Ÿ€%õY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 1 . c s . m e t a     ô    à r     ﬂò    \sõY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ\sõY¿ÏŸ       §               S t a t i c A c t i o n I n v o k e r _ 2 . c s       ô    ê |    ﬂò    >¡õY¿ÏŸ PõÓÇ§ŸzGÿÄ¿‰Ÿ=ËõY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 2 . c s . m e t a      ô    à r     ﬂò    ˜-úY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸCWúY¿ÏŸ       n	               S t a t i c A c t i o n I n v o k e r _ 3 . c s       !ô    ê |     ﬂò    ÓàúY¿ÏŸ PõÓÇ§Ÿ;î’Ä¿‰ŸÛØúY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 3 . c s . m e t a     "ô    à r     ﬂò    >ˇúY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ>ˇúY¿ÏŸ       8
               S t a t i c A c t i  n I n v o k e r _ 4 . c s       #ô    ê |     ﬂò    ºEùY¿ÏŸ PõÓÇ§Ÿ«˝“Ä¿‰Ÿ¿lùY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 4 . c s . m e t a     $ô    à r     ﬂò    Ü©ùY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸã–ùY¿ÏŸ                      S t a t i c A c t i o n I n v o k e r _ 5 . c s       %ô    ê |     ﬂò    #ûY¿ÏŸ PõÓÇ§Ÿ‹t–Ä¿‰Ÿ(-ûY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 5 . c s . m e t a     &ô    Ä n     ﬂò    dXûY¿ÏŸ PõÓÇ§Ÿ&ãœÄ¿‰ŸlûY¿Ï         á               S t a t i c F i e l d A c c e s s o r . c s   'ô    à x     ﬂò    SÕûY¿ÏŸ PõÓÇ§ŸëﬁÕÄ¿‰ŸRŸûY¿ÏŸ¯       Û                S t a t i c F i e l d A c c e s s o r . c s . m e t a (ô    ê z     ﬂò    6üY¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸp5üY¿ÏŸ@      >               S t a t i c F u n c t i o n I n v o k e r B a s e . c s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    using System;
using System.Linq.Expressions;
using System.Reflection;

namespace Unity.VisualScripting
{
    public class StaticFieldAccessor<TField> : IOptimizedAccessor
    {
        public StaticFieldAccessor(FieldInfo fieldInfo)
        {
            if (OptimizedReflection.safeMode)
            {
                if (fieldInfo == null)
                {
                    throw new ArgumentNullException(nameof(fieldInfo));
                }

                if (fieldInfo.FieldType != typeof(TField))
                {
                    throw new ArgumentException("Field type of field info doesn't match generic type.", nameof(fieldInfo));
                }

                if (!fieldInfo.IsStatic)
                {
                    throw new ArgumentException("The field isn't static.", nameof(fieldInfo));
                }
            }

            this.fieldInfo = fieldInfo;
            targetType = fieldInfo.DeclaringType;
        }

        private readonly FieldInfo fieldInfo;
        private Func<TField> getter;
        private Action<TField> setter;
        private Type targetType;

        public void Compile()
        {
            if (fieldInfo.IsLiteral)
            {
                var constant = (TField)fieldInfo.GetValue(null);
                getter = () => constant;
            }
            else
            {
                if (OptimizedReflection.useJit)
                {
                    // Getter

                    var fieldExpression = Expression.Field(null, fieldInfo);
                    getter = Expression.Lambda<Func<TField>>(fieldExpression).Compile();

                    // Setter

                    if (fieldInfo.CanWrite())
                    {
#if UNITY_2018_3_OR_NEWER
                        var valueExpression = Expression.Parameter(typeof(TField));
                        var assignExpression = Expression.Assign(fieldExpression, valueExpression);
                        setter = Expression.Lambda<Action<TField>>(assignExpression, valueExpression).Compile();
#else
                        var setterMethod = new DynamicMethod
                            (
                            "setter",
                            typeof(void),
                            new[] { typeof(TField) },
                            targetType,
                            true
                            );

                        var setterIL = setterMethod.GetILGenerator();

                        setterIL.Emit(OpCodes.Ldarg_0);
                        setterIL.Emit(OpCodes.Stsfld, fieldInfo);
                        setterIL.Emit(OpCodes.Ret);
                        setter = (Action<TField>)setterMethod.CreateDelegate(typeof(Action<TField>));
#endif
                    }
                }
                else
                {
                    // If no JIT is available, we can only use reflection.
                    getter = () => (TField)fieldInfo.GetValue(null);

                    if (fieldInfo.CanWrite())
                    {
                        setter = (value) => fieldInfo.SetValue(null, value);
                    }
                }
            }
        }

        public object GetValue(object target)
        {
            if (OptimizedReflection.safeMode)
            {
                OptimizedReflection.VerifyStaticTarget(targetType, target);

                try
                {
                    return GetValueUnsafe(target);
                }
                catch (TargetInvocationException)
                {
                    throw;
                }
                catch (Exception ex)
                {
                    throw new TargetInvocationException(ex);
                }
            }
            else
            {
                return GetValueUnsafe(target);
            }
        }

        private object GetValueUnsafe(object target)
        {
            return getter.Invoke();
        }

        public void SetValue(object target, object value)
        {
            if (OptimizedReflection.safeMode)
            {
                OptimizedReflection.VerifyStaticTarget(targetType, target);

                if (setter == null)
                {
                    throw new TargetException($"The field '{targetType}.{fieldInfo.Name}' cannot be assigned.");
                }

                if (!typeof(TField).IsAssignableFrom(value))
                {
                    throw new ArgumentException($"The provided value for '{targetType}.{fieldInfo.Name}' does not match the field type.\nProvided: {value?.GetType()?.ToString() ?? "null"}\nExpected: {typeof(TField)}");
                }

                try
                {
                    SetValueUnsafe(target, value);
                }
                catch (TargetInvocationException)
                {
                    throw;
                }
                catch (Exception ex)
                {
                    throw new TargetInvocationException(ex);
                }
            }
            else
            {
                SetValueUnsafe(target, value);
            }
        }

        private void SetValueUnsafe(object target, object value)
        {
            setter.Invoke((TField)value);
        }
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         INDX( 	 ,ST          (   H  Ë       Ÿr    k            aî    à r     ﬂò    ∂Ω≤ÁÏŸ ˚ùØŸÃ_$
ÁÏŸ%Õ$ËÏŸ       €               S t a t i c A c t i o n I n v o k e r _ 1 . c s . m e ô    ê |     ﬂò    n˛öY¿ÏŸ PõÓÇ§ŸŒ	€Ä¿‰Ÿ€%õY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 1 . c s . m e t a     cî    à r     ﬂò     ‰≤ÁÏŸ m˚ùØŸÃ_$
ÁÏŸ“ÜÕ$ËÏŸ       §               S t a t i c A c t i o n I n v o k e r _ 2 . c s . m e ô    ê |     ﬂò    >¡õY¿Ï  PõÓÇ§ŸzGÿÄ¿‰Ÿ=ËõY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 2 . c s . m e t a     eî    à r     ﬂò     ‰≤ÁÏŸ m˚ùØŸÃ_$
ÁÏŸ2sÕ$ËÏŸ       n	               S t a t i c A c t i o n I n v o k e r _ 3 . c s . m e !ô    ê |     ﬂò    ÓàúY¿ÏŸ PõÓÇ§Ÿ;î’Ä¿‰ŸÛØúY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 3 . c s . m e t a     gî    à r     ﬂò    ‡≥ÁÏŸ m˚ùØŸÃ_$
ÁÏŸ LÕ$ËÏŸ       8
               S t a t i c A c t i o n I n v o k e  _ 4 . c s . m e #ô    ê |     ﬂò    ºEùY¿ÏŸ PõÓÇ§Ÿ«˝“Ä¿‰Ÿ¿lùY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 4 . c s . m e t a     iî    à r     ﬂò    úJ≥ÁÏŸp0	˚ùØŸÃ_$
ÁÏŸ%Õ$ËÏŸ                      S t a t i c A c t i o n I n v o k e r _ 5 . c s . m e %ô    ê |     ﬂò    #ûY¿ÏŸ PõÓÇ§Ÿ‹t–Ä¿‰Ÿ(-ûY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 5 . c s . m e t a     &ô    Ä n     ﬂò    dXûY¿ÏŸ PõÓÇ§Ÿ&ãœÄ¿‰ŸlûY¿ÏŸ        á              S t a t i c F i e l d A c c e s s o r . c s   'ô    à x     ﬂò    SÕûY¿ÏŸ PõÓÇ§ŸëﬁÕÄ¿‰ŸRŸûY¿ÏŸ¯       Û                S t a t i c F i e l d A c c e s s o r . c s . m e t a mî    ê z     ﬂò    úJ≥ÁÏŸ†•	˚ùØŸÃ_$
ÁÏŸ%Õ$ËÏŸ@      >               S t a t i c F u n c t i o n I n v o k e r B a s e . c s e . c                              PõÓÇ§Ÿâ£ÀÄ¿‰ŸU¥üY¿ÏŸ¯       Û               ! S t a t i c F u n c t i o n I n v o k e r B a s e . c s . m e t a                   ﬂò    †Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ†Y¿ÏŸ       >               S t a t i c F u n c t i o n I n v o k e r _ 0 . c s   +ô    ê Ä     ﬂò    Ùz†Y¿ÏŸ PõÓÇ§ŸÀ»Ä¿‰ŸÙz†Y¿ÏŸ¯       Û                S t a t i c F u n c t i o n I n v o k e r _ 0 . c s . m e t a ,ô    à v     ﬂò    ‹»†Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸ‹»†Y¿ÏŸ       ˘               S t a t i c F u n c t i o n I n v o k e r _ 1 . c s   -ô    ê Ä     ﬂò    ∆°Y¿ÏŸ PõÓÇ§Ÿ«∆Ä¿‰ŸM?°Y¿ÏŸ¯       Û                S t a t i c F u n c t i o n I n v o  e r _ 1 . c s . m e t a .ô    à v     ﬂò    ‚å°Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸÒü°Y¿ÏŸ       ≈               S t a t i c F u n c t i o n I n v o k e r _ 2 . c s   /ô    ê Ä     ﬂò    íÃ°Y¿ÏŸ PõÓÇ§Ÿò)√Ä¿‰ŸëÛ°Y¿ÏŸ¯       Û                S t a t i c F u n c t i o n I n v o k e r _ 2 . c s . m e t a 0ô    à v     ﬂò    À+¢Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸıP¢Y¿ÏŸ       è	               S t a t i c F u n c t i o n I n v o k e r _ 3 . c s   1ô    ê Ä     ﬂò    &õ¢Y¿ÏŸ PõÓÇ§Ÿ]E¿Ä¿‰Ÿo∞¢Y¿ÏŸ¯       Û               S t a t i c F u n c t i o n I n v o k e r _ 3 . c s . m e t a 2ô    à v     ﬂò    GÎ¢Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸN£Y¿ÏŸ       Y
               S t a t i c F u n c t i o n I n v o k e r _ 4 . c s   3ô    ê Ä     ﬂò    ©E£Y¿ÏŸ PõÓÇ§Ÿ4:ΩÄ¿‰ŸÆl£Y¿ÏŸ¯       Û                S t a t i c F u n c t i o n I n v o k e r _ 4 . c s . m e t a 4ô    à v     ﬂò    ó∫£Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸß÷£Y¿ÏŸ       #               S t a t i c F u n c t i o n I n v o k e r _ 5 . c s   5ô    ê Ä     ﬂò    ﬂ%§Y¿ÏŸ PõÓÇ§ŸÛ|∫Ä¿‰Ÿﬂ%§Y¿ÏŸ¯       Û                S t a t i c F u n c t i o n I n v o k e r _ 5 . c s . m e t a 6ô    Ä j     ﬂò    
o§Y¿ÏŸ PõÓÇ§Ÿ5ú-çÏŸñ§Y¿ÏŸ       V               S t a t i c I n v o k e r B a s e . c s       7ô    à t     ﬂò    ˘„§Y¿ÏŸ PõÓÇ§Ÿ©Ê∑Ä¿‰Ÿ˘„§Y¿ÏŸ¯       Û                S t a t i c I n v o k e r B a s e . c s . m e t a                                                                                                                                  INDX( 	 ZÿJ          (   0  Ë                           Ôò    ò Ä    ﬂò    UjàY¿ÏŸ PõÓÇ§ŸœßÅ¿‰ŸUjàY¿ÏŸ¯       Û                I n s t a n c e A c t i o n I n v o k e r _ 2 . c s . m e t a         ˝ò    † Ñ    ﬂò    QãçY¿ÏŸ PõÓÇ§Ÿt» Å¿‰ŸR≤çY¿ÏŸ¯       Û               ! I n s t a n c e F u n c t i o n I n v o k e r _ 1 . c s . m e t a            ô    Ä h    ﬂò    .ÙìY¿ÏŸ PõÓÇ§ŸãØÌÄ¿‰Ÿ.ÙìY¿ÏŸ¯       Û                I n v o k e r B a s e . c s . m e t a        ô    ò |    ﬂò    \,öY¿ÏŸ PõÓÇ§ŸÜØ›Ä¿‰Ÿm`öY¿ÏŸ¯       Û                S t a t i c A c t i o n I n v o k e r _ 0 . c s . m e t a            )ô    † Ñ    ﬂò    mÉüY¿ÏŸ PõÓÇ§Ÿâ£ÀÄ¿‰ŸU¥üY¿ÏŸ¯       Û               ! S t a t i c F u n c t i o n I n v o k e r B a s e . c s . m e t a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         